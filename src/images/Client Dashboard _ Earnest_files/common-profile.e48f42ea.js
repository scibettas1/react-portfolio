!function(){"use strict";angular.module("clientWww.login",["ui.router","ngAnimate","clientWww.config","App.Core","clientWww.common.filters","clientWww.common","clientWww.common.sso","clientWww.common.baseApi","clientWww.user","clientWww.navigation","common.alerts","common.ui.filters","common.ui.directives","common.api","common.utility.loadPromise","calculators","clientWww.common.exceptionHandler","clientWww.login.resetPassword","clientWww.login.routes","clientWww.login.nav"]).constant("APP_NAME","app-login").config(["$urlRouterProvider","$uiViewScrollProvider",function(a,b){b.useAnchorScroll()}]).run(["analytics","CONFIG",function(a,b){a.load(b.segmentio.apiKey)}])}(),function(){"use strict";angular.module("clientWww.login.routes",["ui.router"]).config(["$stateProvider",function(a){a.state("login",{url:"",views:{nav:{templateUrl:"/login/nav/login-nav.html",controller:"LoginNavController as nav"},layout:{templateUrl:"/login/login/login.html",controller:"LoginController"}},resolve:{checkAuth:["redirect","userModel","$q","APP_URLS",function(a,b,c,d){var e=c.defer();return b.isAuthenticated()?a.hrefUrl(d.dashboardOverview):e.resolve(),e.promise}]}}).state("reset-password",{url:"/password-reset",views:{nav:{templateUrl:"/login/nav/login-nav.html",controller:"LoginNavController as nav"},layout:{templateUrl:"/login/reset-password/reset-password.html",controller:"ResetPasswordController"}}}).state("forgot-password",{url:"/forgot-password",views:{nav:{templateUrl:"/login/nav/login-nav.html",controller:"LoginNavController as nav"},layout:{templateUrl:"/login/forgot-password/forgot-password.html",controller:"ForgotPasswordModalController"}}})}])}(),function(){"use strict";var a=angular.module("clientWww.login.nav",[]),b=function(a,b){this.clientHappinessModal=a,this.state=b};b.prototype.goToLogin=function(){return this.state.go("login")},a.controller("LoginNavController",["clientHappinessModal","$state",b])}(),function(){"use strict";angular.module("clientWww.login.resetPassword",[]).controller("ResetPasswordController",["$scope","userModel","loadPromise","$state","$location","navigationModel","USER_MODEL_ERROR_MESSAGES","redirect","Alerts","SSO",function(a,b,c,d,e,f,g,h,i,j){a.alerts=new i("ResetPassword"),a.errorMessages={verify_password:{required:"Please type a matching password",parse:"Please see password requirements below."},new_password:g.password},a.formData={new_password:"",verify_password:""},a.goToLogin=function(){d.go("login")},a.submit=function(){var f={password_reset:e.search().reset,new_password:a.formData.new_password},g=b.resetPassword(f).then(function(a){d.go("login")});return c(a,g,a.alerts)}}])}(),function(){"use strict";angular.module("clientWww.logout",["ui.router","ngAnimate","ngSanitize","clientWww.config","App.Core","clientWww.common.filters","clientWww.common","clientWww.common.sso","clientWww.common.baseApi","clientWww.user","clientWww.loans","clientWww.navigation","common.alerts","common.ui.filters","common.ui.directives","common.api","common.utility.loadPromise","clientWww.common.exceptionHandler","App.Settings","clientWww.logout.controllers","clientWww.logout.routes"]).constant("APP_NAME","app-logout").config(["$urlRouterProvider","$uiViewScrollProvider",function(a,b){a.otherwise("/logout"),b.useAnchorScroll()}]).run(["analytics","CONFIG",function(a,b){a.load(b.segmentio.apiKey)}])}(),function(){"use strict";angular.module("clientWww.logout.routes",["ui.router"]).config(["$stateProvider",function(a){a.state("logout",{url:"",views:{nav:{templateUrl:"/common/directives/est-loading.html"},layout:{templateUrl:"/logout/logout.html"}},resolve:{checkAuth:["redirect","userModel","$q","APP_URLS","$state","SSO","$rootScope",function(a,b,c,d,e,f,g){if(g.loading=!0,b.isAuthenticated())return b.logout().then(function(){f.ssoRedirectLogout("/")});a.hrefUrl(d.login)}]}})}])}(),function(){"use strict";angular.module("clientWww.logout.controllers",["clientWww.user","clientWww.loans","clientWww.navigation","clientWww.common.pageAlerts"]).controller("LogoutController",["$state",function(a){a.go("logout")}])}(),function(){"use strict";angular.module("clientWww.institutionConnect",["clientWww.institutionConnect.models","clientWww.institutionConnect.api","clientWww.institutionConnect.directives","clientWww.institutionConnect.controllers","ui.router","common.api","clientWww.common.baseApi","clientWww.institutionConnect.api","common.alerts","clientWww.common.modals","clientWww.common.profile.ui-financial.asyncCreateFinancialAccountModal","clientWww.common.profile.ui-financial.asyncInstitutionConnectChallengeModal","common.utility.loadPromise","clientWww.common.pageAlerts","clientWww.profile.profileApi","clientWww.profile.financialAccounts","clientWww.profile.institutionConnectRequests","clientWww.profile.genericProfileModel"]).directive("estInstitutionConnectAuthOnly",[function(){return{restrict:"AE",templateUrl:"/common/institution-connect/partials/index-auth-only.html",scope:{institutionId:"@"},require:"estInstitutionConnectAuthOnly",controller:"InstitutionConnectController",controllerAs:"instConn",link:function(a,b,c,d){d.authOnly=!0}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.controllers",["clientWww.institutionConnect.models","clientWww.institutionConnect.manager"])}(),function(){"use strict";angular.module("clientWww.institutionConnect.models",["common.model"])}(),function(){"use strict";angular.module("clientWww.institutionConnect.directives",[])}(),function(){"use strict";angular.module("clientWww.institutionConnect.api",["common.api","clientWww.common.baseApi"]).service("institutionConnectApi",["$q","baseApi","estLocalStorage","$location",function(a,b,c,d){var e=d.search().force_adapter||c.get("force_adapter");e&&c.setKey("force_adapter",e),this.search=function(a,d,e){var f=c.get("force_adapter"),g={};return g.force_adapter=f,d=d||"",e=e||"",b.request("GET","institutions/search?query="+encodeURIComponent(a)+"&limit="+encodeURIComponent(d+"")+"&offset="+encodeURIComponent(e+""),g)},this.getPopular=function(){var a=c.get("force_adapter"),d={};return d.force_adapter=a,b.request("GET","institutions/popular",d)},this.getInstitutionDetails=function(a){return b.request("GET","institutions/"+a)},this.postInstitutionLogin=function(a,c){return b.request("POST","institutions/"+a+"/login",c)},this.postAnswer=function(a,c){return b.request("POST",a,c)},this.putFinancialAccountLogin=function(a,c){return b.request("PUT","users/me/financial_accounts/"+a+"/login",c)},this.pingForConnectionStatus=function(a){return b.request("GET","users/me/institution_connect_requests/"+a)}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.manager",["clientWww.institutionConnect.models","clientWww.institutionConnect.api"]).factory("InstitutionConnectManager",["$q","institutionConnectApi","$location",function(a,b,c){function d(b){if(this.searchModel=b.searchModel,!this.searchModel)throw new Error("InstitutionConnectManager requires searchModel");if(this.asyncCreateFinancialAccountModal=b.asyncCreateFinancialAccountModal,!this.asyncCreateFinancialAccountModal)throw new Error("InstitutionConnectManager requires asyncCreateFinancialAccountModal");if(this.financialAccountModel=b.financialAccountModel,!this.financialAccountModel)throw new Error("InstitutionConnectManager requires financialAccountModel");if(this.navModel=b.navModel,!this.navModel)throw new Error("InstitutionConnectManager requires navModel");if(this.authModel=b.authModel,!this.authModel)throw new Error("InstitutionConnectManager requires authModel");if(this.challengeModel=b.challengeModel,!this.challengeModel)throw new Error("InstitutionConnectManager requires challengeModel");if(this.pageAlerts=b.pageAlerts,!this.pageAlerts)throw new Error("InstitutionConnectManager requires pageAlerts");if(this.asyncInstitutionConnectChallengeModal=b.asyncInstitutionConnectChallengeModal,!this.asyncInstitutionConnectChallengeModal)throw new Error("InstitutionConnectManager requires asyncInstitutionConnectChallengeModal");var c=this,d={authChallengeCompleted:function(){return c.goToNextTabAndClearSearchModelAndAlerts("search")},afterModal:function(){return c.goToNextTabAndClearSearchModelAndAlerts("search")},cannotConnect:function(a){return c.asyncCreateFinancialAccountModal.open(a).then(function(){return c.hooks.afterModal()})},manualInterventionError:function(b){var d=_.get(c,"authModel.data.home_url");return b.data.message=["Cannot connect. An action is required on your institutions website.",'Please <a target="_blank" href="'+d+'">visit their site</a>,',"and sign in to fix this issue."].join(" "),a.reject(b)},addInstitution:function(){return c.goToNextTabAndClearSearchModelAndAlerts("search")}};this.hooks=_.merge({},d,b.hooks),this.currentFinancialAccountId=void 0}return d.prototype.setCurrentFinancialAccountId=function(a){return this.currentFinancialAccountId=a,this.currentFinancialAccountId},d.prototype.clearCurrentFinancialAccountId=function(){return this.currentFinancialAccountId="",this.currentFinancialAccountId},d.prototype.authForInstitution=function(a,b){var c=this;return this.clearCurrentFinancialAccountId(),this.authModel.getCredentialsForm(a).then(function(){var a="auth";if("inactive"===c.authModel.data.status)return a="error",c.asyncCreateFinancialAccountModal.open({locals:{institutionData:c.authModel.getData(),openedFromError:!0,onClose:function(){c.authModel.clear()}}});c.navModel.setActivePage(a)}).catch(function(a){c.errorInConnection(a,b)})},d.prototype.goToNextTabAndClearSearchModelAndAlerts=function(a){this.navModel.setActivePage(a),this.searchModel.clear()},d.prototype.requestInstitutionDetails=function(a){var c=a||this.currentFinancialAccountId,d=this;return b.getInstitutionDetails(c).then(function(a){var b=_.get(a,"data.challenges");_.get(a,"data.keys")?(d.authModel.updateModelFromResponse(a.data),d.goToNextTabAndClearSearchModelAndAlerts("auth")):b&&(d.challengeModel.updateModelFromResponse(a.data),d.goToNextTabAndClearSearchModelAndAlerts("challenge"))}).catch(function(a){return d.errorInConnection(a)})},d.prototype.errorInConnection=function(b,c){var d=this,e=b.status>=500,f=_.get(b,"data.status");if(e||_.contains(["cannot_connect","auth_required"],f)){var g=_.merge(this.authModel.data,{name:c}),h={locals:{institutionData:g,openedFromError:!0}};return d.hooks.cannotConnect(h)}return b.data&&"manual_intervention"===b.data.status?a.when(this.hooks.manualInterventionError(b)):a.reject(b)},d.prototype.successfulAccountConnection=function(a){var b=this,c=this.currentFinancialAccountId;return this.clearCurrentFinancialAccountId(),this.searchModel.clear(),this.financialAccountModel.refreshFinancialAccounts().then(function(){var d=_.find(b.financialAccountModel.data,{id:c})||_.find(b.financialAccountModel.data,{institution_id:b.authModel.data.id});if(d&&"cannot_connect"===d.connect_status)return b.hooks.cannotConnect({locals:{accountdata:d}});var e=_.get(d,"connect_status");if("active"===e||"pending"===e){var f=["Great! We’ve added this financial institution to your profile","and are attempting to make a connection now."].join(" ");b.pageAlerts.addAlert("success",f)}return b.hooks.addInstitution(a)})},d}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.controllers").directive("estInstitutionConnect",[function(){return{restrict:"AE",templateUrl:"/common/institution-connect/partials/index.html",transclude:!0,scope:{parentForm:"=parentForm",optional:"=optional",options:"=institutionConnectOptions"},require:["?^estDynamicHeight","estInstitutionConnect"],link:function(a,b,c,d){a.estDynamicHeight=d[0],d[1].navModel.onChangeHook()},controller:"InstitutionConnectController",controllerAs:"instConn"}}]).controller("InstitutionConnectController",["$state","$rootScope","$scope","Alerts","pageAlerts","financialAccountModel","InstitutionConnectAuthModel","InstitutionConnectChallengeModel","InstitutionConnectNavModel","institutionConnectPopularInstitutionsModel","loadPromise","InstitutionConnectManager","asyncCreateFinancialAccountModal","asyncInstitutionConnectChallengeModal","$timeout","InstitutionConnectSearchModel","analytics",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){function r(a){return k(t,a,u)}function s(a){return r(f.retryLogin(a.id)).then(function(b){if(w.setCurrentFinancialAccountId(a.id),!b.data.mfa)return b.data?c.authModel.getCredentialsForm(a.institution_id).then(function(){w.goToNextTabAndClearSearchModelAndAlerts("auth",t.navModel)}):(w.clearCurrentFinancialAccountId(),f.refreshFinancialAccounts());t.challengeModel.data=b.data,w.goToNextTabAndClearSearchModelAndAlerts("challenge",t.navModel)}).catch(function(b){return w.clearCurrentFinancialAccountId(),t.alerts.addAlert("error",b.message),t.asyncCreateFinancialAccountModal.open({locals:{accountData:a,isAuthRequired:!0,openedFromError:!0}})})}var t=this,u=this.alerts=new d("InstitutionConnectAlerts");u._original_addAlert=u.addAlert,u.addAlert=function(a,b,d,e,f){q.track("institution-connect-error",{message:b,code:d,status:e}),q.track("Unable to Connect to Financial Institution",{"Institution Name":t.authModel.data.name,"Institution ID":t.authModel.data.id,"Error Code":d,"Error Message":b}),c.estDynamicHeight&&o(function(){c.estDynamicHeight.refreshHeight()}),u._original_addAlert(a,b,d,e,f)},u._originalClearAll=u.clearAll,u.clearAll=function(){var a=this;return c.estDynamicHeight&&o(function(){0===a.items.length&&c.estDynamicHeight.refreshHeight()}),u._originalClearAll()},this.navModel=new i,this.authModel=new g,this.challengeModel=new h,this.searchModel=new p,this.PopularAccounts=j.data,this.parentForm=c.parentForm,this.accountType=_.get(c,"options.accountType"),this.localLoadPromise=r,this.pageAlerts=e,this.authRequired=_.get(c,"options.authRequired"),this.financialAccountModel=f,this.asyncCreateFinancialAccountModal=m,this.asyncInstitutionConnectChallengeModal=n;var v={searchModel:this.searchModel,asyncCreateFinancialAccountModal:this.asyncCreateFinancialAccountModal,asyncInstitutionConnectChallengeModal:this.asyncInstitutionConnectChallengeModal,financialAccountModel:this.financialAccountModel,navModel:this.navModel,authModel:this.authModel,challengeModel:this.challengeModel,pageAlerts:this.pageAlerts,hooks:_.merge({},_.get(c,"options.hooks",{})),useModalFallback:_.get(c,"options.useModalFallback",!1)},w=new l(v);this.institutionConnectManager=w,this.navModel.data.activePage="search",this.authRequired&&(this.navModel.data.activePage="empty"),this.loading=!1,this.hasCheckingAccounts=function(){return f.hasBankingAccount()||f.hasPendingAccount()||f.hasAuthRequiredAccount()},this.activeGrid=this.accountType||"banks",c.setActiveGrid=function(a){t.activeGrid=a||"banks"},this.navModel.onChangeHook=function(){if(c.estDynamicHeight)return o(function(){c.estDynamicHeight.refreshHeight()})},c.$watch("options.challengeData",function(){if(_.get(c,"options.challengeData"))return s(c.options.challengeData).then(function(){c.options.challengeData=void 0,u.clearAll()})}),this.showError=function(){var a=this.hasCheckingAccounts();return!c.optional&&!a&&c.parentForm&&c.parentForm.$submitted}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.directives").directive("estInstitutionConnectStart",[function(){return{restrict:"E",templateUrl:"/common/institution-connect/directives/est-institution-connect-start.html",replace:!0,require:"^estInstitutionConnect",scope:{},link:function(a,b,c,d){a.goToSearch=function(){d.navModel.data.activePage="search"}}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.directives",["clientWww.profile.profileConstants"]).controller("InstitutionConnectAuthController",["$scope","$exceptionHandler","ProfileErrorMessages","analytics",function(a,b,c,d){var e=function(a){if(a&&400===a.status)return c.financial_accounts.intuit_unresponsive_message.message},f=function(){return a.instConn.authModel.postInstitutionLogin(a.financialAccountId).then(function(b){return _.get(b,"data.mfa")?(d.track("Visited Financial Institution MFA Modal",{"Institution ID":a.instConn.authModel.data.id,"Institution Name":a.instConn.authModel.data.name}),a.instConn.challengeModel.updateModelFromResponse(b.data),a.instConn.institutionConnectManager.goToNextTabAndClearSearchModelAndAlerts("challenge",a.instConn.navModel),b):(d.track("Financial Institution Connected",{"Institution ID":a.instConn.authModel.data.id,"Institution Name":a.instConn.authModel.data.name}),a.instConn.institutionConnectManager.successfulAccountConnection(b.data))}).catch(function(b){return _.isUndefined(b.message)||(b.message=e(b)),a.instConn.institutionConnectManager.errorInConnection(b)})};a.submitAuth=function(){if(d.track("Clicked Connect Financial Institution",{"Institution ID":a.instConn.authModel.data.id,"Institution Name":a.instConn.authModel.data.name}),!a.instConn.loading)return a.connect_accounts_auth_form.$setSubmitted(!0),a.connect_accounts_auth_form.$valid?a.instConn.localLoadPromise(f()):void 0}}]).directive("estInstitutionConnectAuth",["analytics",function(a){return{restrict:"AE",templateUrl:"/common/institution-connect/directives/est-institution-connect-auth.html",require:"^estInstitutionConnect",controller:"InstitutionConnectAuthController",link:function(b,c,d,e){b.instConn=e,b.financialAccountId=e.institutionConnectManager.currentFinancialAccountId,a.track("Visited Financial Institution Modal",{"Institution Name":b.instConn.authModel.data.name,"Institution ID":b.instConn.authModel.data.id})}}}])}(),function(){"use strict";var a=angular.module("clientWww.institutionConnect.directives"),b=function(a,b,c){function d(){return a.instConn.challengeModel.submitChallengeResponses(a.financialAccountId,a.instConn.authModel.data.id).then(function(b){return b.mfa?a.instConn.challengeModel:a.instConn.institutionConnectManager.successfulAccountConnection(b.data)}).catch(function(b){c.track("Unable to Validate Financial Institution MFA",{"Institution ID":a.instConn.authModel.data.id,"Institution Name":a.instConn.authModel.data.name});var d={408:"This security question has expired. Please re-enter your account credentials to get a new question."},e=d[b.status]||_.get(b,".data.message")||b.message;return b.message=e,a.instConn.institutionConnectManager.requestInstitutionDetails(a.instConn.challengeModel.data.institution_id).then(function(){if(b.status>=400)return a.instConn.institutionConnectManager.errorInConnection(b)})})}a.goToAuthTab=function(){var b="auth";a.instConn.challengeModel.mfa||(b="search"),a.instConn.institutionConnectManager.goToNextTabAndClearSearchModelAndAlerts(b)},a.submitChallenge=function(){if(c.track("Clicked Submit MFA Challenge",{"Institution Name":a.instConn.authModel.data.name,"Institution ID":a.instConn.authModel.data.id}),!a.loading)return a.connect_accounts_challenge_form.$setSubmitted(!0),a.connect_accounts_challenge_form.$valid?a.instConn.localLoadPromise(d()).then(function(b){a.instConn.challengeModel.updateModelFromResponse(b)}).catch(function(b){var c=b.status||_.get(b,".data.status");a.instConn.alerts.addAlert("error",b.message||b,void 0,c)}):void 0}};a.controller("InstitutionConnectChallengeController",["$scope","$exceptionHandler","analytics",b]),a.directive("estInstitutionConnectChallenge",[function(){return{restrict:"AE",templateUrl:"/common/institution-connect/directives/est-institution-connect-challenge.html",require:"^estInstitutionConnect",controller:"InstitutionConnectChallengeController",link:function(a,b,c,d){a.instConn=d,a.financialAccountId=d.institutionConnectManager.currentFinancialAccountId,a.challengeModel=d.challengeModel}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.directives").directive("estInstitutionConnectGrid",[function(){return{restrict:"E",templateUrl:"/common/institution-connect/directives/est-institution-connect-grid.html",replace:!0,require:"^estInstitutionConnect",link:function(a,b,c,d){a.instConn=d,a.submitSearch=function(a,b){return d.localLoadPromise(d.institutionConnectManager.authForInstitution(a,b))}}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.directives").directive("estInstitutionConnectSearch",["clientHappinessModal",function(a){return{restrict:"E",templateUrl:"/common/institution-connect/directives/est-institution-connect-search.html",require:"^estInstitutionConnect",link:function(b,c,d,e){b.name=d.name,b.searchData=e.searchModel,b.openHappinessModal=function(){return a.open()},b.iconActive=!1,b.isAsyncHandleHide=function(){return!(b.searchData.query&&b.searchData.query.length<=0||!b.searchData.query)},b.goToTab=function(){e.institutionConnectManager.goToNextTabAndClearSearchModelAndAlerts()},b.showAll=function(){e.searchModel.setLimit(100)},b.replaceUrlParams=function(a){if(a){var b=/^(?:https?:\/\/)?(?:www\.)?(.*)\.(?=[\w.]{3,4})/im,c=a.match(b,"");return c&&c.length>0?c[1]:a}};var f=_.debounce(function(){e.searchModel.setLimit(10),e.searchModel.submitSearch()},400),g=b.selectItem=function(a){if(a)return e.searchModel.selectItem(a),e.localLoadPromise(e.institutionConnectManager.authForInstitution(a)).then(function(){e.searchModel.clear()})};b.toggleIcon=function(){b.iconActive=!b.iconActive},b.openAddAccountModal=function(){var a={name:b.replaceUrlParams(b.searchData.query)};return e.searchModel.clear(),e.asyncCreateFinancialAccountModal.open({locals:{isAuthRequired:!0,institutionData:a,type:"add_account"}})};var h=function(a){e.searchModel.setActiveItem(a)};b.keyup=function(a){switch(a.keyCode){case 38:a.preventDefault(),h(-1);break;case 40:a.preventDefault(),h(1);break;case 9:case 13:a.preventDefault(),g(b.searchData.results&&e.searchModel.activeIndex>0?b.searchData.results[b.searchData.activeIndex].id:e.searchModel.selectedId);break;default:f()}}}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.directives").directive("estInstitutionConnectError",[function(){return{restrict:"E",templateUrl:"/common/institution-connect/directives/est-institution-connect-error.html",replace:!0,require:"^estInstitutionConnect",link:function(a,b,c,d){return a.institutionName=d.authModel.data.name,d.asyncCreateFinancialAccountModal.open({locals:{accountData:d.authModel.data,openedFromError:!0}}).then(function(){d.navModel.data.activePage="search"})}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect").factory("InstitutionConnectAuthModel",["institutionConnectApi","$q","$interval","institutionConnectRequestModel","financialAccountModel",function(a,b,c,d,e){return function(){this.data={},this.account={},this.attributes={home_url:"",id:"",keys:[],name:"",remote_id:"",status:""},this.updateModelFromResponse=function(a){var b=this;return a=a||{},_.forEach(this.attributes,function(c,d){a.hasOwnProperty(d)&&(b.data[d]=a[d])}),b.data},this.clear=function(){this.updateModelFromResponse(this.attributes)},this.getCredentialsForm=function(b){var c=this;return a.getInstitutionDetails(b).then(function(a){return c.updateModelFromResponse(a.data)})},this.getData=function(){return this.data},this.postInstitutionLogin=function(b){var f=this,g={};angular.forEach(this.data.keys,function(a){g[a.name]=a.val});var h;return h=b?a.putFinancialAccountLogin(b,{credentials:g,async:!0}):a.postInstitutionLogin(this.data.id,{credentials:g,async:!0}),h.then(function(b){d.getUnsuccessfulRequests();var g=function(){a.pingForConnectionStatus(b.data.uuid).then(function(a){"connecting"!==a.data.status&&(d.getUnsuccessfulRequests(),e.refreshFinancialAccounts(),c.cancel(h))})},h=c(function(){g()},2e3);return f.data.keys=[],b})}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect").factory("InstitutionConnectChallengeModel",["CommonModelDocument","institutionConnectApi",function(a,b){return function(){this.data={},this.attributes={mfa:null,institution_id:""},this.updateModelFromResponse=function(a){var b=this;return a=a||{},_.forEach(this.attributes,function(c,d){a.hasOwnProperty(d)&&(b.data[d]=a[d])}),b.data.challenge_response=b.data.challenge_response||[],b.data},this.clear=function(){this.updateModelFromResponse(this.attributes)},this.submitChallengeResponses=function(a,c){var d=_.assign({},this.data.mfa,{answers:this.data.challenge_response}),e={id:c,mfa:d,challenge_node_id:_.get(d,"providerContext.challengeNodeId"),challenge_session_id:_.get(d,"providerContext.challengeSessionId"),answers:this.data.challenge_response,metadata:this.data.metadata||{}};return function(d){return d?b.postAnswer(e.metadata.url,e):a?b.putFinancialAccountLogin(a,e):b.postInstitutionLogin(c,e)}(e.metadata.url).then(function(a){return this.clear(),this.updateModelFromResponse(a.data)}.bind(this))}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.models").factory("InstitutionConnectNavModel",[function(){var a={activePage:"",activeTab:"",pages:["start","search","auth","challenge","why","error"]};return function(){this.data=_.clone(a),this.onChangeHook=function(){},this.setActivePage=function(a){this.data.activePage=a,this.onChangeHook()}}}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.models").factory("InstitutionConnectSearchModel",["institutionConnectApi","$filter",function(a,b){var c,d=function(){this.autocompleteVisible=!1,this.limit="",this.search="",this.selectedId="",this.results=[],this.activeIndex=-1,this.error=!1},e=!0;return d.prototype.clearResults=function(){this.activeIndex=-1,this.selectedId="",this.results=[]},d.prototype.clear=function(){this.clearResults(),this.query=""},d.prototype.setLimit=function(a){this.limit=a},d.prototype.selectItem=function(a){var b=_.findIndex(this.results,{id:a});b>-1&&(this.query=this.results[b].name,this.selectedId=this.results[b].id)},d.prototype.setActiveItem=function(a){var b=_.findIndex(this.results,{id:this.selectedId});this.activeIndex=-1===b?0:b+a,this.activeIndex>-1&&this.results[this.activeIndex]?(this.selectedId=this.results[this.activeIndex].id,this.query=this.results[this.activeIndex].name):(this.selectedId="",this.query="")},d.prototype.submitSearch=function(){this.error=!1;var d=this;return this.loading=!0,e&&(a.getPopular().then(function(a){c=a.data.banks.concat(a.data.credit_cards).concat(a.data.investments).concat(a.data.loans),d.popularResults=c}),e=!1),a.search(this.query).then(function(a){d.activeIndex=-1,d.results=b("orderBy")(a.data,"name"),d.loading=!1,0===d.results.length&&(d.error=!0)})},d}])}(),function(){"use strict";angular.module("clientWww.institutionConnect.models").factory("institutionConnectPopularInstitutionsModel",["institutionConnectApi","CommonModelDocument",function(a,b){return new b("popular-accounts",{banks:[],credit_cards:[],loans:[],investments:[]},function(){return a.getPopular()})}])}(),function(){"use strict";angular.module("App.Core",["clientWww.common","ui.router","clientWww.config","clientWww.loanApp.core.initCoreModels","clientWww.loanApp.core.initModels","clientWww.loanApp.core.accessControl","clientWww.user","clientWww.loans","clientWww.source","clientWww.common.baseApi","clientWww.common.sso"])}(),function(){"use strict";angular.module("clientWww.loanApp.core.initCoreModels",["ui.router"]).factory("initCoreModels",["$q","userModel","redirect",function(a,b,c){return function(){return b.getModel().catch(function(b){return b.status?c.hrefUrl("/"):a.reject(b)})}}])}(),function(){"use strict";angular.module("clientWww.loanApp.core.initModels",["ui.router","clientWww.selfCertification","clientWww.loanPriceOffer","clientWww.models.home"]).factory("initModels",["Loan","sourceModel","$q","userModel","financialAccountModel","$location","assetModel","incomeModel","educationModel","employmentModel","loanPurposeDegreeModel","LoanList","navigationModel","QuickRateScoreModel","redirect","estLocalStorage","constants","STUDENT_LOAN_TYPES","SelfCertification","LoanPriceOffer","HomeDashboardCards",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=function(){},w=function(b){var c=a.getQuickScoreId(b)||"";return n.getScore(c).catch(function(a){return a})},x=function(b){var c=a.getQuickScoreId(b)||"";return n.getQuickScoreDashboardOffer(c).catch(function(a){return a})},y=function(b){var c=a.getQuickScoreId(b,"cosigner")||"";return n.getScore(c).catch(function(a){return a})},z=function(d){var e;return d=d||m.data.loan_id||p.get("loan_id"),d?c.all([a.getOne(d),m.getState(d)]).then(function(a){return m.data.loan_id=d,e=a[0],e&&e.attributes.source_id?b.refreshSource(e):c.when()}).then(function(){if(e&&e.attributes.application&&"cosigner"===e.attributes.application.applicant_role)y(e);else{if(!e||!a.isStudentLoan()||_.isNumber(e.attributes.rate_score))return c.when();w(e),x(e)}}).then(function(){if(e&&"student_loan_origination"===e.attributes.type){var a=_.get(e.attributes,"application.id");return s.getSelfCertification(a).then(function(a){return _.assign(e.attributes,{self_certification:a}),e})}return e}):c.when()};return v.prototype.initSingleDashboardLoan=function(a){return a=a||p.get("loan_id"),c.when().then(function(){var b=[z(a)];return d.attributes.data.id||b.push(d.getModel()),c.all(b)})},v.prototype.initDashboardModels=function(){if(d.isAuthenticated())return c.all([d.getModel(),l.getAll(),u.init()]).then(function(a){var b=[];return _.each(a[1],function(a){if(_.includes(r,a.type)){var c=w(a),d=x(a);b.push(c),b.push(d)}if("student_loan_origination"===a.type){var e=s.getSelfCertification(a.application.id).then(function(b){_.assign(a,{self_certification:b})});b.push(e)}a.offer_used_in_checkout&&b.push(t.getDashboardOffer(a.id))}),c.all(b).then(function(b){return{promises:b,loans:a[1],sloLoans:a[2]}})})},v.prototype.initDashboardProfile=function(){if(d.isAuthenticated()){var a=[d.getModel(),g.getAll(),h.getAll(),i.getAll(),j.getAll(),e.getAll(),l.getAll()];return c.all(a)}},v.prototype.initBasicProfile=function(){var m;if(d.isAuthenticated()){var n=[l.getAll(),d.getModel(),g.getAll(),h.getAll(),i.getAll(),j.getAll(),e.getAll()];a.attributes.data.id||n.push(z()),m=c.all(n).then(function(b){if(a.attributes.data.id)return k.updateLoanId(),k.getAll()})}else m=a.updateModelFromCookie();return m.then(function(){var c=f.search();if(c.source||a.attributes.data.source_id)return b.getSource(c,a)})},v.prototype.initBasicCosignerProfile=function(){if(d.isAuthenticated()){var k=[d.getModel(),g.getAll(),h.getAll(),i.getAll(),j.getAll(),e.getAll(),l.getAll()];return a.attributes.data.primary.first_name||k.push(z()),c.all(k)}return c.when().then(function(){a.updateModelFromCookie();var c=f.search();if(c.source||a.attributes.data.source_id)return b.getSource(c,a)})},new v}])}(),function(){"use strict";angular.module("clientWww.loanApp.core.accessControl",["clientWww.config"]).factory("accessControlRules",["$q","loginModal","$state","navigationModel","userModel","Loan","redirect","CONFIG","redirectToMyUi",function(a,b,c,d,e,f,g,h,i){function j(a){return d.setCurrentLoanId(a.id),d.getState().then(function(){return c.go(d.state_name)})}function k(a,b){return"personal"===b&&"personal"===a.type||"student"===b&&f.isStudentLoan(a)}var l=function(){},m=function(){if(b.accessWasDenied=!0,!e.registerModalOpen&&!e.loginModalOpen)return b.open().then(function(a){return"logged-in"===a?c.go("dashboard.overview",{},{reload:!0}):g.hrefUrl("/")})},n=function(){return g.hrefUrl("/dashboard/#/overview")},o=function(){return e.isAuthenticated()?a.when(!0):m()};return l.prototype.accessProfile=function(){return e.isAuthenticated()?a.when(!0):m()},l.prototype.accessProfileStep=function(b,c,f){return e.isAuthenticated()?b&&b.id?i.shouldRedirect()?i.redirect(f):"apply"===b.status&&k(b,c)?a.when(!0):(d.setCurrentLoanId(b.id),d.getState().then(function(){return g.hrefUrl(d.url)})):n():m()},l.prototype.accessProfileComplete=function(){return o().then(function(){return"student.profile.review"===d.state_name||"profile.review"===d.state_name||"cosigner.profile.review"===d.state_name?a.when(!0):c.go(d.state_name,d.data)})},l.prototype.accessProfileStart=function(b,d,f){
return e.isAuthenticated()?(f=f||0,_.each(b.data,function(b){if(k(b,d)){if("apply"===b.status&&b.quick_score_expired&&h.featureFlags.rateCheckExpirationEnabled)return i.shouldRedirect()?i.redirect(c.current.name):a.when();if(f!==b.id&&"apply"===b.status)return j(b);if("pending"===b.status)return n()}}),i.redirect(c.current.name)):a.when(!0)},l.prototype.accessDashboard=function(){return a.when(o())},new l}])}(),function(){"use strict";angular.module("App.Core").config(["$httpProvider",function(a){var b=["$q","$injector","redirect","APP_URLS","CONFIG",function(a,b,c,d,e){var f,g,h;return{request:function(a){return e.inMaintenanceMode&&!/\/common\//.test(a.url)&&c.hrefUrl(d.maintenance),a},responseError:function(e){return f=f||b.get("loginModal"),g=g||b.get("userModel"),e&&e.message&&e.data.message||(e.message="Unknown error, please try again. If this error continues please email hello@earnest.com."),e.config.url.match(/linkedin.com/i)?(h=h||b.get("$exceptionHandler"),h(e,"linkedin error"),e.message="We were unable to connect to LinkedIn, please try again. If this problem continues please email hello@earnest.com",a.reject(e)):401!==e.status||g.registerModalOpen||g.loginModalOpen?503!==e.status?a.reject(e):void c.hrefUrl(d.maintenance):a.reject(e)}}}];a.interceptors.push(b),a.defaults.transformResponse.push(function(a){var b=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,c=function(a){var c=a.match(b);return c?new Date(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3],10)):a},d=function(a){var b;if("object"!=typeof a)return a;angular.forEach(a,function(e,f){if(_.contains(["updated_at","created_at","deleted_at","createdAt"],f))return void(a[f]=e?new Date(e):e);_.contains(["linkedin_id","remote_id","id","loan_number"],f)||(b=e,a.hasOwnProperty(e)||("string"==typeof b?a[f]=c(b):"object"==typeof b&&d(b)))})};return d(a),a})}])}(),function(){"use strict";angular.module("App.Core").config(["$provide",function(a){a.decorator("maxlengthDirective",["$delegate",function(a){var b=function(a,b,c,d){if(d){var e=0;c.$observe("maxlength",function(a){e=parseInt(a,10)||0,d.$validate()}),d.$validators.maxlength=function(a,b){return c.$attr&&c.$attr.estCurrencyInput&&(e+=2),d.$isEmpty(b)?d.$isEmpty(b):b.toString().length<=e}}};return a[0].compile=function(){return b},a}]),a.decorator("$state",["$delegate","$stateParams",function(a,b){return a.forceReload=function(){return a.go(a.current,b,{reload:!0,inherit:!1,notify:!0})},a}])}])}(),function(){"use strict";angular.module("App.Settings",["App.Settings.Controllers","App.Settings.Modals"]).config(["$stateProvider",function(a){a.state("settings",{url:"/settings",views:{nav:{templateUrl:"/common/nav/primary-nav.html",controller:"PrimaryNavController as nav"},layout:{templateUrl:"/common/settings/partials/index.html",controller:"SettingsController"}},abstract:!0,resolve:{init:["initCoreModels",function(a){return a()}]}}).state("settings.account",{url:"",resolve:{loanList:["LoanList",function(a){return a.getAll()}]},views:{content:{templateUrl:"/common/settings/partials/account.html",controller:"SettingsAccountController"}}})}])}(),function(){"use strict";angular.module("App.Settings.Controllers",["clientWww.common.modals.navientSync","clientWww.config"]).controller("SettingsController",[function(){}]).controller("SettingsAccountController",["$scope","CONFIG","userModel","loanList","changePasswordModal","changeEmailModal","redirect","APP_URLS","NavientSyncModal",function(a,b,c,d,e,f,g,h,i){a.User=c,a.californiaPrivacyRightsUrl=b.californiaPrivacyRightsUrl,a.changeEmailEnabled=!_.some(d,{targeted_for_loanpro:!0,status:"active"}),a.loanServicedByNavient=_.find(d,function(a){return"navient"===a.loan_servicer&&a.is_boarded&&a.is_serviced}),a.email=c.attributes.data.email,a.changePassword=function(){e.open()},a.changeEmail=function(){a.changeEmailEnabled&&f.open().then(function(b){!0===b&&a.loanServicedByNavient&&a.loanServicedByNavient.id&&i.open({locals:{loanId:a.loanServicedByNavient.id}})})},a.cancel=function(){g.hrefUrl(h.dashboardOverview)}}])}(),function(){"use strict";angular.module("App.Settings.Modals",[])}(),function(){"use strict";angular.module("App.Settings.Modals").controller("ChangePasswordModalController",["userModel","loadPromise","$scope","$state","navigationModel","pageAlerts","Alerts","USER_MODEL_ERROR_MESSAGES",function(a,b,c,d,e,f,g,h){c.alerts=new g("ChangePasswordModal"),c.errorMessages={verify_password:{required:"Please type a matching password",verify_password:"The Confirmed Password does not match."},new_password:h.password},c.submit=function(){var g={old_password:c.form.old_password,new_password:c.form.new_password},h=a.changePassword(g).then(function(){c.close(),d.go(e.state_name),f.addAlert("success","Your password has been changed.",void 0,void 0,3e3)});return b(c,h,c.alerts)}}]).factory("changePasswordModal",["EstModalFactory",function(a){return new a({name:"change-password",templateUrl:"/common/settings/modals/change-password-modal.html",controller:"ChangePasswordModalController"})}])}(),function(){"use strict";angular.module("App.Settings.Modals").controller("ChangeEmailModalController",["userModel","loadPromise","$scope","$state","navigationModel","pageAlerts","Alerts",function(a,b,c,d,e,f,g){c.alerts=new g("ChangeEmailModal"),c.userModel=a,c.maxlength=50,c.errorMessages={new_email:{new_email:"Please enter a new email address",maxlength:"Max number of characters allowed is "+c.maxlength+"."}},c.submit=function(){var g={current_password:c.form.current_password,new_email:c.form.new_email},h=a.changeEmail(g).then(function(){c.close(!0),d.go(e.state_name),f.addAlert("success","Your email has been changed.",void 0,void 0,3e3)});return b(c,h,c.alerts)}}]).factory("changeEmailModal",["EstModalFactory",function(a){return new a({name:"change-email",templateUrl:"/common/settings/modals/change-email-modal.html",controller:"ChangeEmailModalController"})}])}(),function(){"use strict";angular.module("clientWww.profile",["clientWww.profile.profileService","clientWww.profile.assets","clientWww.profile.incomes","clientWww.profile.financialAccounts","clientWww.profile.institutionConnectRequests","clientWww.profile.educations","clientWww.profile.employments","clientWww.profile.profileConstants","clientWww.profile.pollFinancialAccountStatus","clientWww.common.baseApi","clientWww.profile.profileApi","clientWww.profile.genericProfileModel"])}(),function(){"use strict";angular.module("clientWww.profile.assets",[]).factory("assetModel",["GenericProfileModel",function(a){var b={id:void 0,type:void 0,value:void 0};return new(a.createSubclass("assets",b))}])}(),function(){"use strict";angular.module("clientWww.profile.incomes",[]).factory("incomeModel",["GenericProfileModel",function(a){var b={id:void 0,type:void 0,value:void 0,employment_id:void 0},c=a.createSubclass("incomes",b);return c.prototype.batchSave=function(){this.data=_.filter(this.data,function(a){if(parseInt(a.value,10)>=0)return a}),a.prototype.batchSave.call(this)},new c}])}(),function(){"use strict";angular.module("clientWww.profile.financialAccounts",["clientWww.profile.genericProfileModel"]).factory("financialAccountModel",["GenericProfileModel","$log","$injector","ProfileApi",function(a,b,c,d){var e={id:"",remote_id:"",name:"",institution_name:"",type:"",sub_type:"",balance:"",image:"",connect_status:""},f=a.createSubclass("financial_accounts",e);f.prototype.batchCreate=function(a){var b=this;return d.post("financial_accounts",a).then(function(){return b.refreshFinancialAccounts()})},f.prototype.deleteItem=function(a,b){var c=this;return d.delete("financial_accounts",a).then(function(){return c.data.splice(b,1)})},f.prototype.hasBankingAccount=function(){var a=this;return!!_.find(a.data,{type:"banking"})},f.prototype.hasInvestmentAccount=function(){var a=this;return!!_.find(a.data,{type:"investment"})},f.prototype.hasPendingAccount=function(){var a=this;return!!_.find(a.data,{connect_status:"pending"})},f.prototype.hasAuthRequiredAccount=function(){var a=this;return!!_.find(a.data,{connect_status:"auth_required"})},f.prototype.hasValidAccount=function(){var a=this;return!!_.find(a.data,function(a){return _.contains(["checking"],a.sub_type)&&!_.contains(["pending","auth_required"],a.connect_status)})},f.prototype.deleteAllFinancialAccounts=function(){return d.deleteAllFinancialAccounts()},f.prototype.refreshFinancialAccounts=function(){var a=this;return a.isRefreshingAccounts=!0,d.get("financial_accounts").then(function(b){return a.isRefreshingAccounts=!1,a.updateLocalModel(b)}).catch(function(b){throw a.isRefreshingAccounts=!0,b})},f.prototype.startPoling=function(){c.invoke(["pollFinancialAccountStatus",function(a){return a()}])},f.prototype.retryLogin=function(a){return d.retryLogin(a)},f.prototype.AssetAccountTypes={BANKING:"banking",INVESTMENT:"investment"},f.prototype.sumAssetAccounts=function(){var a=this,b=0;return _.forEach(a.data,function(c){_.contains(a.AssetAccountTypes,c.type)&&(b+=c.balance)}),b},f.prototype.paymentAccounts=function(){return _.filter(this.data,function(a){return _.any(["banking"===a.type&&"checking"===a.sub_type,"banking"===a.type&&"savings"===a.sub_type,"banking"===a.type&&"banking"===a.sub_type])})};var g=new f;return g.isRefreshingAccounts=!1,g}])}(),function(){"use strict";angular.module("clientWww.profile.institutionConnectRequests",[]).factory("institutionConnectRequestModel",["GenericProfileModel","ProfileApi",function(a,b){var c={status:void 0,institution_name:void 0,response_data:void 0},d=a.createSubclass("institution_connect_requests",c);return d.prototype.getUnsuccessfulRequests=function(a){a=a||{status:"connecting,mfa_required,error"};var c=this;return b.get("institution_connect_requests",a).then(function(a){return c.updateLocalModel(a)})},d.prototype.deleteRequestsForInstitution=function(a){var c=this;return b.delete("institution_connect_requests",a).then(function(a){return c.updateLocalModel(a)})},new d}])}(),function(){"use strict";angular.module("clientWww.profile.educations",["common.model","clientWww.config","clientWww.profile.genericProfileModel","clientWww.profile.profileApi","calculators.constants"]).factory("educationModel",["GenericProfileModel","constants",function(a,b){var c={id:"",degree:"",structured_degree:"",structured_degree_version:"",field_of_study:"",school_name:"",start_date:{year:"",month:""},end_date:{year:"",month:""},linkedin_id:"",status:"",school_id:"",remote_name:"",misc:{gpa:"",gpa_max:"",awards:""}},d=b.getVersionedDegrees(),e=_.reduce(d,function(a,b,c){return a[c]=b.value,a},{});Object.freeze(e);var f=_.reduce(b.EDUCATION_TIME_COMMITMENTS,function(a,b,c){var d={title:_.capitalize(b.replace("_","-")),value:b};return a[c]=d,a},{});Object.freeze(f);var g=_.reduce(d,function(a,c){return _.contains(c.tags,b.DEGREE_TAGS.GRADUATE)&&a.push(c.value),a},[]),h=_.reduce(d,function(a,c){return _.contains(c.tags,b.DEGREE_TAGS.UNDERGRAD)&&a.push(c.value),a},[]),i=_.union(h,g),j={COMPLETED:"completed",CURRENT:"current",FUTURE:"future",TRANSFERRED:"transferred",NOT_COMPLETED:"not_completed"},k=a.createSubclass("educations",c);return k.prototype.updateLocalModel=function(b){a.prototype.updateLocalModel.call(this,b),_.each(this.data,function(b){b.start_date=b.start_date||{},b.end_date=b.end_date||{},b.isItemComplete=!0,"not_completed"!==b.status&&a.prototype.checkForEmptyValues.call(this,["status","field_of_study","school_name","structured_degree"],b)&&(b.isItemComplete=!1),"previous"!==b.status||b.start_date.year&&b.end_date.year||(b.isItemComplete=!1),_.isNull(b.status)&&(b.status="")})},k.prototype.hasCurrent=function(){return!!_.find(this.data,{status:"current"})},k.prototype.hasCompleted=function(){return!!_.find(this.data,{status:j.COMPLETED})},k.prototype.hasUndergradDegree=function(){return _.reduce(this.data,function(a,b){return a||!!_.contains(h,b.structured_degree)},!1)},k.prototype.hasGraduateDegree=function(){return _.reduce(this.data,function(a,b){return a||!!_.contains(g,b.structured_degree)},!1)},k.prototype.hasHigherEducation=function(){function a(a){return!!_.contains(i,a.structured_degree)}function b(a){return _.contains([j.COMPLETED,j.CURRENT],a.status)}return _.reduce(this.data,function(c,d){return c||a(d)&&b(d)},!1)},k.prototype.hasCurrentOrFutureNotEndingSoon=function(){function a(a){return a.status===j.FUTURE||moment(a.end_date).diff(moment(),"months")>d}function b(a){return _.contains([j.FUTURE,j.CURRENT],a.status)}function c(a){return _.contains([f.FULL_TIME.value,f.HALF_TIME.value],a.time_commitment)}var d=6;return _.reduce(this.data,function(d,e){return d||b(e)&&c(e)&&a(e)},!1)},k.prototype.earliestCompletedEducationEndDate=function(){var a=_.sortByOrder(_.filter(this.data,{status:j.COMPLETED}),function(a){return moment(a.end_date).toDate()},"desc");return a&&a.length>0?a[0].end_date:null},k.DEGREE_TYPES=k.prototype.DEGREE_TYPES=d,k.Statuses=k.prototype.Statuses=j,k.TimeCommitments=k.prototype.TimeCommitments=f,new k}])}(),function(){"use strict";var a=angular.module("clientWww.profile.employments",["common.model","clientWww.common.getDevice"]),b={PREVIOUS:"previous",CURRENT:"current",FUTURE:"future"},c={FULL_TIME:"full_time",PART_TIME:"part_time",SELF_EMPLOYED:"self_employed",BUSINESS_OWNER:"business_owner",INTERNSHIP:"internship"},d=[{key:c.FULL_TIME,value:"Full-Time Employee"},{key:c.PART_TIME,value:"Part-Time Employee"},{key:c.SELF_EMPLOYED,value:"Self-Employed (Less than 25% of income is reported on a W-2)"},{key:c.BUSINESS_OWNER,value:"Business Owner & Employer"}],e=[{key:b.PREVIOUS,value:"Previous Employer"},{key:b.CURRENT,value:"Current Employer"},{key:b.FUTURE,value:"Future Employer"}];a.factory("employmentModel",["GenericProfileModel","getDevice","CONFIG",function(a,f,g){var h={id:"",title:"",company_name:"",start_date:{year:"",month:""},end_date:{},linkedin_id:"",part_time:void 0,type:void 0,status:b.CURRENT,city:"",state:"",salary:void 0};if(g.featureFlags.medicalResidencyEnabled&&(c.MEDICAL_RESIDENCY="medical_residency",d.push({key:c.MEDICAL_RESIDENCY,value:"Medical Residency"})),this.getDevice=f,this.getDevice.isMobileBrowser)for(var i in d)d[i].key===c.SELF_EMPLOYED&&(d[i].value="Self-Employed");var j=a.createSubclass("employments",h);return j.Types=j.prototype.Types=c,j.Statuses=j.prototype.Statuses=b,j.StatusSelectOptions=j.prototype.StatusSelectOptions=e,j.TypeSelectOptions=j.prototype.TypeSelectOptions=d,j.prototype.updateLocalModel=function(b){a.prototype.updateLocalModel.call(this,b),_.each(this.data,function(b){b.start_date=b.start_date||{},b.end_date=b.end_date||{},b.isItemComplete=!0,b.start_date.month&&b.start_date.year||(b.isItemComplete=!1),a.prototype.checkForEmptyValues.call(this,["status","title","company_name"],b)&&(b.isItemComplete=!1),"current"!==b.status&&"future"!==b.status||!a.prototype.checkForEmptyValues.call(this,["city","state","type"],b)||(b.isItemComplete=!1),"current"===b.status&&(b.misc&&void 0!==typeof b.misc.ending_soon||(b.isItemComplete=!1)),"previous"!==b.status||b.end_date.month&&b.end_date.year||(b.isItemComplete=!1),_.isNull(b.state)&&(b.state="")})},j.prototype.getFutureFullTimeEmployers=function(){return _.filter(this.getFutureEmployers(),function(a){return a.type===c.FULL_TIME||a.type===c.MEDICAL_RESIDENCY})},j.prototype.getCurrentFullTimeEmployers=function(){return _.filter(this.getCurrentEmployers(),function(a){return a.type===c.FULL_TIME||a.type===c.MEDICAL_RESIDENCY})},j.prototype.getPreviousFullTimeEmployers=function(){return _.filter(this.getPreviousEmployers(),function(a){return a.type===c.FULL_TIME||a.type===c.MEDICAL_RESIDENCY})},j.prototype.getCurrentEmployers=function(){return _.filter(this.data,function(a){return"current"===a.status})},j.prototype.getCurrentAndFutureEmployers=function(){return _.filter(this.data,function(a){return"current"===a.status||"future"===a.status})},j.prototype.getFutureEmployers=function(){return _.filter(this.data,function(a){return a.type!==c.INTERNSHIP&&"future"===a.status})},j.prototype.getPreviousEmployers=function(){return _.filter(this.data,function(a){return a.type!==c.INTERNSHIP&&"previous"===a.status})},j.prototype.getOldestEmployment=function(){var a=_.sortByOrder(_.filter(this.data,function(a){return a.start_date&&a.start_date.month&&a.start_date.year&&(a.status===j.Statuses.PREVIOUS||a.status===j.Statuses.CURRENT)}),function(a){return moment({year:a.start_date.year,month:a.start_date.month-1}).toDate()},"asc");return a&&a.length>0?a[0]:null},j.prototype.hasCurrentEmployer=function(){return!!_.find(this.data,{status:j.Statuses.CURRENT})},j.prototype.hasFutureEmployer=function(){return!!_.find(this.data,{status:j.Statuses.FUTURE})},j.prototype.hasPreviousEmployer=function(){return!!_.find(this.data,{status:j.Statuses.PREVIOUS})},j.prototype.hasFullTimeCurrentEmployer=function(){return!!_.find(this.data,function(a){return a.status===j.Statuses.CURRENT&&(a.type===c.FULL_TIME||a.type===c.MEDICAL_RESIDENCY)})},j.prototype.hasFullTimeFutureEmployer=function(){return!!_.find(this.data,function(a){return a.status===j.Statuses.FUTURE&&(a.type===c.FULL_TIME||a.type===c.MEDICAL_RESIDENCY)})},j.prototype.hasFullTimePreviousEmployer=function(){return!!_.find(this.data,function(a){return a.status===j.Statuses.PREVIOUS&&(a.type===c.FULL_TIME||a.type===c.MEDICAL_RESIDENCY)})},j.prototype.isFutureEmploymentRequired=function(){var a=_.filter(this.data,{status:"current"}),b=_.filter(a,{misc:{ending_soon:!0}});return!(0===b.length||a.length>b.length)},j.prototype.addInternshipType=function(){d.push({key:c.INTERNSHIP,value:"Internship"})},j.prototype.getSLOStudentImportantEmployers=function(a){var b,c,d=this.getFutureFullTimeEmployers(),e=this.getCurrentFullTimeEmployers(),f=_.filter(this.getPreviousFullTimeEmployers(),function(b){return moment(a).subtract(1,"years").isBefore(moment(b.end_date))});return d.length>0?(b=d,c="future"):e.length>0?(b=e,c="current"):f.length>0&&(b=f,c="previous"),{type:c,employment:b||[]}},j.prototype.addFutureEmployer=function(){a.prototype.addItem.call(this),this.data[0].status=j.Statuses.FUTURE},j.prototype.addPreviousEmployer=function(){a.prototype.addItem.call(this),this.data[0].status=j.Statuses.PREVIOUS},j.prototype.hasTwoPlusYearsWorkExperience=function(){return _(this.data).filter(function(a){var c=_.pick(b,["CURRENT","PREVIOUS"]);return _.includes(c,a.status)}).reduce(function(a,b){var c=moment(),d=moment(),e=_.get(b.end_date,"month");return c.year(b.start_date.year),c.month(b.start_date.month-1),d.year(_.get(b.end_date,"year")),d.month(e?e-1:void 0),moment(d,"YYYYM").diff(moment(c,"YYYYM"))+a},0)>=6307e7},j.prototype.hasMissingStartDates=function(){return _(this.data).filter(function(a){return _.includes([b.CURRENT,b.PREVIOUS],a.status)}).some(function(a){return!a.start_date.year||!a.start_date.month})},new j}])}(),function(){"use strict";angular.module("clientWww.profile.profileApi",["clientWww.common.baseApi"]).factory("ProfileApi",["$q","baseApi",function(a,b){var c=function(){};return c.prototype.get=function(a,c){return b.request("GET","users/me/"+a,c)},c.prototype.put=function(a,c,d){return b.request("PUT","users/me/"+a+"/"+c,d)},c.prototype.post=function(a,c){return b.request("POST","users/me/"+a,c)},c.prototype.delete=function(c,d){return d?b.request("DELETE","users/me/"+c+"/"+d):a.when()},c.prototype.createProfileFromLinkedInData=function(a){return b.request("PUT","linkedin",a)},c.prototype.exchangeLinkedInAccessToken=function(a){return b.request("POST","linkedin/access_token",{authToken:a})},c.prototype.deleteAllFinancialAccounts=function(){return b.request("DELETE","users/me/financial_accounts")},c.prototype.retryLogin=function(a){return b.request("POST","users/me/financial_accounts/"+a+"/retry_login",{credentials:{}})},c.prototype.getPendingInstitutionStatus=function(a){return b.request("GET","users/me/financial_account_requests/"+a)},c.prototype.getAllPendingInstitutionStatuses=function(){return b.request("GET","users/me/financial_account_requests")},new c}])}(),function(){"use strict";angular.module("clientWww.profile.profileService",[]).factory("profileHelpers",["$q","ipCookie","CONFIG","ProfileApi",function(a,b,c,d){var e=function(){};return e.prototype.connectLinkedIn=function(e){if(!e)return a.reject("Cannot connectLinkedIn without data");var f="linkedin_oauth_"+c.linkedIn.clientId,g=b(f)||{},h=g.authToken||"";return d.createProfileFromLinkedInData({linkedin:e}).then(function(){return d.exchangeLinkedInAccessToken(h).catch(function(a){console.log(a)})})},new e}]).factory("pollFinancialAccountStatus",["$rootScope","financialAccountModel","$timeout",function(a,b,c){var d,e=2e4,f=function(){return _.any(b.model.data,function(a){return"pending"===a.connect_status})},g=function(a){a=a||e,d&&(c.cancel(d),d=void 0);var h=f();return h&&(d=c(function(){return b.refreshFinancialAccounts().catch(function(){c(function(){g(a)},a)})},a)),h};return a.$on("est-profile-updated",function(a,b){var c=b&&b.pollFinancialAccountStatusDelay||void 0;g(c)}),g}])}(),function(){"use strict";angular.module("clientWww.profile.profileConstants",[]).constant("ProfileErrorMessages",{loan_purposes:{moving_location:{required:"Please enter a location."},moving_date:{day:"Please enter a valid date.",month:"Please enter a valid month.",futureyear:"Please enter a valid year.",parse:"Please enter a valid birthdate in MM/DD/YYYY format.",required:"Please enter a moving date."},moving_living_situation_other_explain:{required:"Please elaborate on your future living situation."},employer_reimbursement_amount:{required:"Please enter an amount."},employer_change:{required:"Please select a response."},new_employer_name:{required:"Please enter your new employer's name."},new_salary:{required:"Please enter your expected annual salary."},engagement_wedding_situation:{required:"Please select a response."},engagement_ring_cost:{required:"Please enter an amount.",max:"Max loan amount is $50,000."},wedding_cost:{required:"Please enter an amount.",max:"Max loan amount is $50,000."},wedding_date:{day:"Please enter a valid date.",month:"Please enter a valid month.",futureyear:"Please enter a valid year.",parse:"Please enter a valid birthdate in MM/DD/YYYY format.",required:"Please enter a wedding date."},home_improvement_type:{required:"Please select a response."},home_improvement_other_explain:{required:"Please elaborate on your planned home improvement."},home_improvement_cost:{required:"Please enter an amount.",max:"Max loan amount is $50,000."},trip_length:{},trip_cost:{required:"Please enter your trip cost.",max:"Max loan amount is $50,000."},organization_name:{required:"Please enter an Organization Name."},career_development_type:{required:"Please select a response."},program_type:{required:"Please select a response."},program_acceptance:{required:"Please select a response."},accreditation_type:{required:"Please select a response."},accreditation_type_other_explain:{required:"Please elaborate on your accreditation type."},program_start_date:{required:"Please enter valid start & end dates.",invalid:"Please enter valid start & end dates.",month:"Please enter valid start & end dates.",day:"Please enter valid start & end dates.",year:"Please enter valid start & end dates.",date_range_error_message:"Please enter a valid date range."},program_end_date:{required:"Please enter valid start & end dates.",invalid:"Please enter valid start & end dates."},program_cost:{required:"Please enter an amount.",max:"Max loan amount is $50,000."},new_job_start_date:{day:"Please enter a valid date.",month:"Please enter a valid month.",futureyear:"Please enter a valid year.",parse:"Please enter a valid birthdate in MM/DD/YYYY format.",required:"Please enter a start date."},future_housing_cost:{max:"Max loan amount is $50,000."},security_deposit_amount:{max:"Max loan amount is $50,000."}},educations:{school_name:{required:"Please enter the name of your school."},degree_type:{required:"Please enter your degree type."},education_dates:{required:"Please enter valid dates.",pattern:"Please enter valid dates in MM/YYYY format.",month:"Please enter a valid month.",year:"Please enter valid dates in MM/YYYY format.",date_range_error_message:"Please enter a valid date range."},field_of_study:{required:"Please enter your major(s)."},gpa:{pattern:"Please enter a numerical GPA."},time_commitment:{required:"Please select your time commitment, full-time, half-time, or part-time"},city_state:{required:"Please enter a city and state"}},employments:{company_name:{valid:"Company Name",required:"Please enter a company name."},title:{valid:"Title",required:"Please enter your job title."},employment_dates:{required:"Please enter valid dates.",pattern:"Please enter valid dates in MM/YYYY format.",month:"Please enter a valid month.",year:"Please enter valid dates in MM/YYYY format.",dates_error_message:"Please enter dates appropriate for the selected employment status"},city_state:{required:"Please enter your employer's city."},type:{required:" Please select an employment type,"}},financial_accounts:{total_annual_salary:{required:"Please enter your total annual salary.",pattern:"Please enter your total annual salary."},intuit_unresponsive_message:{message:"Connecting to your bank account is temporarily unavailable. Please try again in a few minutes."}},incomes:{type:{required:"Please select an income type."},value:{required:"Please enter a value."}},assets:{type:{required:"Please select an asset type."},value:{required:"Please enter a value."}},personal:{first_name:{required:"Please enter your first name."},missed_payments_general:{required:"Please select an option."},last_name:{required:"Please enter your last name."},date_of_birth:{day:"Please enter a valid date.",month:"Please enter a valid month.",parse:"Please enter a valid birthdate in MM/DD/YYYY format.",required:"Please enter a valid birthdate in MM/DD/YYYY format."},street_1:{required:"Please enter your street address."},city:{required:"Please enter your city."},state:{required:"Please select your state."},zip:{required:"Please enter your Zip Code.",pattern:"This Zip code is invalid.  It can only contain 5 digits.",zipcode:"This Zip code is invalid.  It can only contain 5 digits."},monthly_rent:{required:"Enter the amount you pay each month for rent."},living_situation:{required:"Please select your living situation."},living_situation_length:{required:"Please select an option.",pristine:"Please select an option."},living_situation_other_explain:{required:"Please elaborate on your current living situation."},mobile_phone:{required:"Please enter your mobile phone number.",pattern:"Please enter a valid phone number."},citizenship_status:{required:"Please select a citizenship status."},citizenship_visa_type:{required:"Please select a Visa Type."},citizenship_expiration_date:{day:"Please enter a valid date.",month:"Please enter a valid month.",futureyear:"Please enter a future year.",parse:"Please enter a valid expiration date.",required:"Please enter a valid expiration date."}},check_rate:{first_name:{required:"Please enter your first name."},last_name:{required:"Please enter your last name."},state:{required:"Please select your state."},zip:{required:"Please enter your Zip Code.",pattern:"This Zip code is invalid.  It can only contain 5 digits.",zipcode:"This Zip code is invalid.  It can only contain 5 digits."},grad_date:{required:"Please enter valid date.",pattern:"Please enter valid date in MM/YYYY format.",month:"Please enter a valid month.",year:"Please enter valid date in MM/YYYY format.","time-period":"Please enter valid date.",parse:"Please enter valid date.",date_range_error_message:"Please enter a valid date range."},degree_start_date:{required:"Please enter valid date.",pattern:"Please enter valid date in MM/YYYY format.",month:"Please enter a valid month.",year:"Please enter valid date in MM/YYYY format.","time-period":"Please enter valid date.",parse:"Please enter valid date."},latest_school:{required:"Please enter the school for your highest degree."},latest_degree:{required:"Please select your highest degree."},current_employer:{required:"Please enter the name of your employer."},job_title:{required:"Please enter your job title."},annual_income:{required:"Please enter your estimated total annual income.",min:"An income is required in order to refinance with Earnest. If you have a job coming up on the horizon, please enter your future income."},savings_investment_total:{required:"This is an estimated total of your retirement, investment, and  savings accounts, plus your average checking account balance.",min:"Even if you do not have very much in savings, please enter an approximate estimate of the total value of your investment and banking accounts."},refinance_amount:{required:"Please enter your approximate amount to refinance.",min:"The minimum amount to refinance is $5,000.",max:"Amount to refinance must be less than $500,000."},estimated_loan_amount:{required:"Please enter your approximate amount to borrow.",min:"The minimum student loan amount is $2,000.",max:"Sorry, your requested loan amount cannot exceed the calculated maximum loan amount."},housing_payment:{required:"Whatever you personally spend per month for a roof over your head, whether it's your share of rent or a mortgage payment."},email:{required:"Please enter a valid email address.",invalid:"Please enter a valid email address."},whose_education:{required:"Please enter at least one degree.",invalid:"Please fill out all fields for each degree."}}}).constant("profileYesNoOptions",[{label:"Choose One",value:""},{label:"Yes",value:!0},{label:"No",value:!1}])}(),function(){"use strict";angular.module("clientWww.profile.pollFinancialAccountStatus",[]).factory("pollFinancialAccountStatus",["$rootScope","financialAccountModel","$timeout",function(a,b,c){var d,e=2e4,f=function(){return _.any(b.data,function(a){return"pending"===a.connect_status})},g=function(a){a=a||e,d&&(c.cancel(d),d=void 0);var h=f();return h&&(d=c(function(){return b.refreshFinancialAccounts().catch(function(){c(function(){g(a)},a)})},a)),h};return a.$on("est-profile-updated",function(a,b){var c=b&&b.pollFinancialAccountStatusDelay||void 0;g(c)}),g}])}(),function(){"use strict";angular.module("clientWww.profile.genericProfileModel",["clientWww.profile.profileApi"]).factory("GenericProfileModel",["ProfileApi","$q","$rootScope",function(a,b,c){var d=function(b,c,d,e){this.emptyData=c,this.section=b,this.data=[_.clone(this.emptyData)];var f={get:"get",create:"post",save:"put",delete:"delete"};e=e||{},this.methods=_.extend(f,e),this.api=d||a};return d.prototype.updateLocalModel=function(a){var b,d=this.data;return this.data.splice(-this.data.length),b=a,a.data&&_.isArray(a.data)&&(b=a.data),d.push.apply(d,b),this.data=d,c.$emit("est-profile-updated"),this.data},d.prototype.checkForEmptyValues=function(a,b){return _.any(a,function(a){return!b[a]})},d.prototype.addItem=function(a,b){a=a||0,_.isEmpty(b)&&(b=_.cloneDeep(this.emptyData)),this.data.splice(a,0,b)},d.prototype.getAll=function(){var a=this;return this.api[this.methods.get](a.section).then(function(b){a.updateLocalModel(b)})},d.prototype.createItem=function(a){var b=this;return this.api[this.methods.create](b.section,a).then(function(b){a.id=b.data&&b.data.id})},d.prototype.saveItem=function(a,b){return this.api[this.methods.save](this.section,a,b).then(function(a){b.id=a.data&&a.data.id})},d.prototype.deleteItem=function(a,c){var d=this;return a?this.api[this.methods.delete](d.section,a).then(function(){return d.data.splice(c,1)}):(d.data.splice(c,1),b.when())},d.prototype.batchSave=function(a){var c=this;a=a||c.data;var d=[];return _.each(a,function(a){a.id?a.isDirty&&a.id&&d.push(c.saveItem(a.id,a)):d.push(c.createItem(a))}),0===d.length?b.when(c.data):b.all(d)},d.prototype.batchDelete=function(a){var c=this;a=a||c.data;var d=[];return _.each(a,function(a){a.id&&d.push(c.deleteItem(a.id))}),0===d.length?b.when(c.data):b.all(d)},
d.createSubclass=function(a,b,c,e){var f=function(f){var g=f||a;d.prototype.constructor.call(this,g,b,c,e)},g=function(){};return g.prototype=d.prototype,f.prototype=new g,f.prototype.constructor=f,f.model=b,f},d}])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.common.helpSidebar",[]),b=function(a){this.happinessModal=a};a.controller("HelpSidebarController",["clientHappinessModal",b])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.common.profileHeader",["clientWww.common.services.loanProgressService","clientWww.common.services.cobranded","clientWww.navigation.navigationModel","clientWww.common.helpers.redirect","clientWww.loans.loansModel","clientWww.config","clientWww.user","ui.router"]),b=function(a,b,c,d,e,f,g,h,i,j){function k(){l.showEditLink=-1===_.indexOf(m,a.current.name),l.showLoanAmount=-1===_.indexOf(n,a.current.name)}var l=this,m=["student.check-rate.start","profile.start","student.profile.start"],n=["student.check-rate.start","student.profile.personal","student.profile.review"];this.currentStepNumber=1,this.loanData=d.attributes.data,this.userData=e.attributes.data,this.currentState=a.current,this.showLoanAmount=!0,this.navigationModel=h,this.loanStatus=d.attributes.data.status,this.profileStates=i.profileStates,this.showCosignerStep=_.find(this.profileStates,function(a){return"add_cosigner"===a.key}),this.isCobranded=j.isTurboTaxClient(),this.displayRateCheckNotice=function(){return b.featureFlags.rateCheckExpirationEnabled&&"student_loan_refinance"===this.loanData.type&&"apply"===this.loanData.status&&this.loanData.quick_score_expired},this.showCombineResultsAndStartStepText=i.combineResultsAndStartStep&&"student.profile.start"===this.currentState.name,this.startStepText=this.showCombineResultsAndStartStepText?"Rate Check Results":"Loan Details",this.goToRateCheck=function(){c.hrefUrl("/student/#/check-rate")},k(),i.initWidget(),i.updateWidget(),this.activeState=i.activeState,this.status=i.status,d.cosignerEligible()&&"student.profile.review"===this.currentState.name?this.currentStepNumber=this.currentState.data.stepNumberWithCosignerFlow:this.currentStepNumber=this.currentState.data.stepNumber,this.isCobranded&&this.currentStepNumber--,f.$on("$stateChangeSuccess",function(){l.currentState=a.current,l.activeState=i.activeState,l.status=i.status,k()})};a.controller("ProfileHeaderController",["$state","CONFIG","redirect","Loan","userModel","$rootScope","$scope","navigationModel","loanProgressService","Cobranded",b])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.common.profileWidget",["clientWww.common.services.cobranded"]),b=function(a,b,c,d,e,f,g,h){switch(this.$state=b,this.userData=c.attributes.data,this.profileOtherData=c.attributes.data.misc.others,this.navigationModel=e,this.loanStatus=d.attributes.data.status,this.isCobranded=h.isTurboTaxClient(),d.attributes.data.type){case g.refinance:this.title="STUDENT LOAN REFI";break;case g.origination:this.title="STUDENT LOAN";break;default:this.title="PERSONAL LOAN"}this.profileStates=f.profileStates,this.startStepText=f.combineResultsAndStartStep?"Rate Check Results":"Loan Details";var i=this;f.initWidget(),f.updateWidget(),this.showCosignerStep=_.find(this.profileStates,function(a){return"add_cosigner"===a.key}),this.activeState=f.activeState,this.status=f.status,a.$on("$stateChangeSuccess",function(){i.activeState=f.activeState,i.status=f.status})};a.controller("ProgressWidgetController",["$rootScope","$state","userModel","Loan","navigationModel","loanProgressService","STUDENT_LOAN_TYPES","Cobranded",b])}(),function(){"use strict";angular.module("clientWww.common.directives.estRoutingNumber",[]).directive("estRoutingNumber",[function(){return{require:"ngModel",priority:999,link:function(a,b,c,d){var e=function(a){if(d.$pristine)return!0;if(!a||9!==a.length)return!1;for(var b=a.toString().split(""),c=[],e=0;e<b.length;e++)c.push(parseInt(b[e],10));return!(c[8]!==(7*(c[0]+c[3]+c[6])+3*(c[1]+c[4]+c[7])+9*(c[2]+c[5]))%10)};d.$setValidity("routing_number",!1),d.$parsers.unshift(function(a){return""===a||void 0===a?void d.$setValidity("routing_number",!1):a.replace(/[^a-zA-Z]/g,"")?void d.$setValidity("routing_number",!1):(a=a.trim().replace(/[^0-9]/g,""),e(a)?(d.$setValidity("routing_number",!0),e(a)&&a||void 0):void 0)})}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estPhoneNumber",[]).directive("estPhoneNumber",[function(){return{restrict:"A",require:"ngModel",priority:1,scope:{number:"="},link:function(a,b,c,d){if(d){a.$watch("number.one+number.two+number.three",function(a){var b=new RegExp(/^[2-9][0-9]{2}[2-9][0-9]{6}$/g);a&&b.test(a)?d.$setViewValue(a.toString()):d.$setViewValue(null)});var e=function(b){b&&(a.number={one:b.substring(0,3),two:b.substring(3,6),three:b.substring(6,10)})};d.$formatters.push(e),b.on("keyup",function(a){var b=angular.element(a.target);/^\d*$/.test(b.val())?b.removeClass("bad-input"):b.addClass("bad-input")})}}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estSsnInput",[]).directive("estSsnInput",[function(){return{restrict:"A",require:"ngModel",priority:1,scope:{number:"="},link:function(a,b,c,d){if(d){a.$watch("number.ssn1+number.ssn2+number.ssn3",function(a){a&&a.match(/[0-9]{9}/g)&&d.$setViewValue(a.toString())});var e=function(b){b&&(a.number={ssn1:b.substring(0,3),ssn2:b.substring(3,5),ssn3:b.substring(5,9)})};d.$formatters.push(e),b.on("keyup",function(a){var b=angular.element(a.target);/^\d*$/.test(b.val())?b.removeClass("bad-input"):b.addClass("bad-input")})}}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estEnter",[]).directive("estEnter",["$timeout",function(a){return{scope:{estEnter:"&"},link:function(b,c){c.bind("keypress",function(c){13===c.which&&a(function(){b.estEnter(),c.preventDefault()},0)})}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estDateFormatter",[]).directive("estDateFormatter",[function(){return{priority:1,restrict:"A",require:"ngModel",scope:{date:"=date"},link:function(a,b,c,d){if(d){b.on("change",function(){if(a.date&&a.date.year&&a.date.month&&a.date.day){var b=new Date(Date.UTC(a.date.year,a.date.month-1,a.date.day)),c=b.toISOString();d.$setViewValue(c)}});var e=function(b){if(b){var c=new Date(b),d=c.getUTCHours()>11?1:0,e=c.getUTCDate()+d,f=c.getUTCMonth()+1;e>31&&(e=1,f+=1),a.date={day:e,month:f,year:c.getUTCFullYear()}}};d.$formatters.push(e)}}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estSelectOther",[]).directive("estSelectOther",["$timeout",function(a){return{restrict:"A",require:["ngModel","^form"],priority:-1,link:function(b,c,d,e){function f(){a(function(){p.find("#"+d.nextInputId).focus()})}function g(a,b){a[n]=!1,a[l]=void 0,b[m].$setValidity("required",!0)}function h(a){var c=k[m].$valid;return a&&"other"!==a||(k[m].$setValidity("required",c),j.$setValidity("required",c),p.find('input[name="'+m+'"]').focus()),n&&(b[n]=!0),void 0!==i?i:k[m].$viewValue}var i,j=e[0],k=e[1],l=d.estSelectOther,m=d.otherName||d.estSelectOther,n="false"!==d.toggleOther&&"showOther",o=!1,p=c.closest(d.estSelectOtherContext);j.$parsers.unshift(function(a){return"other"!==a?(d.nextInputId&&f(),g(b,k),a):h(a)}),j.$formatters.unshift(function(a){return!o&&a&&c.find('option[value="'+a+'"]')[0]?a:(o=!0,a&&""!==a?(b[n]=!0,b[l]=a,j.$setValidity("required",!0),"other"):void(b[n]?k[m].$setValidity("required",!1):j.$setValidity("required",!1)))}),b.$watch(l,function(a){return i=a,(void 0!==a||!a&&"other"===j.$modelValue)&&(j.$$lastCommittedViewValue=void 0,j.$setViewValue("other"),k[m].$setValidity("required",!!a),j.$setValidity("required",!0),j.$setValidity("parse",!0),b[n]=!0),a})}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estAutoTab",[]).directive("estAutoTab",[function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.bind("keyup",function(a){if(!_.isUndefined(c.maxlength)&&!_.isUndefined(d.$viewValue)&&9!==a.keyCode&&16!==a.keyCode&&d.$viewValue.length===parseInt(c.maxlength,10)){var b=document.getElementById(c.nextInputId);b&&b.focus()}})}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estSetInvalid",[]).directive("estSetInvalid",[function(){return{restrict:"A",require:"form",link:function(a,b,c,d){var e=function(a,b){a?d.$setValidity(b,!1):d.$setValidity(b,!0)};a.checkValues=function(a,b){e(a>b,"maxValueExceeded")},a.checkEquality=function(a,b){e(a===b,"inequal")}}}}])}(),function(){"use strict";function a(a){return a.ngModelUsesTitle?a.titleField:a.idField}var b,c=angular.module("clientWww.common.directives.estAutocomplete",[]),d="autocompleteItem needs to be a valid object with keys id, title [,subtitlel] ",e="No results found",f="Initial value not found",g="There was an error with the api search function passed in.",h="There was an errr with the autocompleteSearch";c.provider("estAutocompleteDefaults",function(){var a={ngModelUsesTitle:!1,idField:"id",titleField:"title",subtitleField:"subtitle",displayLimit:7,placeholder:"Enter School Name",debounce:300,allowManualInput:!1,resultsTitle:"Results",callbackOnSelect:void 0,callbackOnBlur:void 0,initializeNotFoundMsg:f,invalidItemMsg:d,noResultsFoundMsg:e};return{$get:function(){return a},set:function(b){var c,d;for(c in b)b.hasOwnProperty(c)&&(d=b[c],a[c]=d);return a}}}),c.directive("estAutocomplete",[function(){return{restrict:"A",require:"ngModel",templateUrl:"/common/directives/est-autocomplete.html",replace:!0,scope:{autocompleteSearch:"="},link:function(a,b,c,d){function e(b){var c=a.autocompleteSearch;return b=b||c.getModelViewValue(),g(b)}function f(b){var c=a.autocompleteSearch;return b&&c.initWithModelValue(b),g(b)}var g=function(a){return"required"in c&&(void 0===a||null===a)?h.options.allowManualInput&&h.selectedItem&&h.selectedItem.title?(d.$setValidity("required",!0),-1):(d.$setValidity("required",!1),null):h.isSelectedItemOk()?(d.$setValidity("autocomplete",!0),d.$setValidity("required",!0),a):(d.$setValidity("autocomplete",!1),null)};a.inputValueModelOptions={debounce:400},d.$parsers.push(e),d.$formatters.push(f);var h=a.autocompleteSearch;a.$watch(function(){return h.selectedItem},function(a,b){a!==b&&d.$setViewValue(h.getModelViewValue())}),h.options.placeholder=c.placeholder||h.options.placeholder}}}]),c.directive("estAutocompleteInputValue",[function(){return{restrict:"A",require:"ngModel",scope:!1,link:function(a,c,d,e){function f(b){var c=a.autocompleteSearch;return!1!==c.isFocused?(c.goSearch(b),b):(c.isSelectedItemOk()||(e.$setViewValue(""),c._prepareSearch(),e.$render()),b)}b=c,a.$on("$destroy",function(){b=void 0}),c.on("keydown",function(b){var c=a.autocompleteSearch;a.$apply(function(){switch(b.keyCode){case 38:b.preventDefault(),c.setActiveIndex(c.activeIndex-1);break;case 40:b.preventDefault(),c.setActiveIndex(c.activeIndex+1);break;case 9:break;case 13:-1!==c.activeIndex&&c.isSelectedItemOk(c.results[c.activeIndex])&&(c.selectItemByIndex(),b.preventDefault())}})}),c.on("mouseover",function(){a.autocompleteSearch.unsetActiveIndex()});var g=c.closest("[est-focus-element]");c.on("blur",function(){var b=a.autocompleteSearch;a.$apply(function(){b.isFocused=!1,b.isAnItemSelected()||b.selectItemByIndex(),g.removeClass("focus")}),void 0!==b.options.callbackOnBlur&&b.options.callbackOnBlur(b)}),c.on("focus",function(){a.autocompleteSearch.isFocused=!0,g.addClass("focus")}),e.$parsers.push(f)}}}]),c.directive("estAutocompleteItem",[function(){return{restrict:"A",scope:!1,link:function(a,c){c.on("mouseover",function(){var b=a.autocompleteSearch;a.$apply(function(){b.setActiveIndex(a.$index)})}),c.on("mousedown",function(c){var d=a.autocompleteSearch;a.$apply(function(){c.preventDefault(),d.selectItemByIndex(a.$index),b.focus()})})}}}]),c.factory("AutocompleteSearch",["$q","estAutocompleteDefaults",function(b,c){var d=function(a,b){this.inputValue="",this.selectedItem=void 0,this.results=[],this.activeIndex=-1,this.errorMessage=!1,this.noResultsFound=!1,this.loading=!1,this.setApiSearch(a),this.isFocused=void 0,this.options=angular.extend({},c,b),this.limit=this.options.displayLimit};return d.prototype.initWithModelValue=function(c){var d=a(this.options),e=this;if(this.selectedItem&&this.selectedItem[d]===c)return b.when(!0);var f={};return f[d]=c,this.options.ngModelUsesTitle&&(this.inputValue=c),e.isFocused=!0,this.goSearch(f).then(function(){e.results.length<=3&&e.setSelectedItem(e.results[0])})},d.prototype.setApiSearch=function(a){if("function"!=typeof a)throw new Error("estAutocomplete requires apiSearch function");this._apiSearch=a},d.prototype._prepareSearch=function(){this.noResultsFound=!1,this.errorMessage=!1,this.unsetActiveIndex(),this.selectedItem=void 0,this.loading=!1},d.prototype.isAnItemSelected=function(){return this.selectedItem&&-1===this.activeIndex&&this.inputValue===this.selectedItem.title},d.prototype.getManualOption=function(){return{id:-1,title:this.inputValue}},d.prototype.goSearch=function(a){a=void 0===a?this.inputValue:a;var c=this;if(this._prepareSearch(),!a)return c.loading=!1,this.results=[],b.when(!0);var d;return"object"==typeof a?d=a:(d={},d[this.options.titleField]=void 0===a?this.inputValue:a),this.loading=!0,this._apiSearch(d).then(function(a){return c.loading=!1,!1!==c.isFocused&&(angular.isArray(a)&&0!==a.length?("id"===c.options.idField&&"title"===c.options.titleField&&"subtitle"===c.options.subtitleField||(a=a.map(function(a){return c._normalizeItem(a)})),c.inputValue.length>2&&a.push(c.getManualOption()),c.results=a,c.setActiveIndex(0),c.results):(c.errorMessage=!angular.isArray(a)&&g,c.noResultsFound=!0,c.inputValue.length>2?c.results=[c.getManualOption()]:c.results=[],c.results))}).catch(function(a){return c.loading=!1,c.errorMessage=h,b.reject(a)})},d.prototype._normalizeItem=function(a){return{id:a[this.options.idField],title:a[this.options.titleField],subtitle:a[this.options.subtitleField]}},d.prototype._selectItem=function(a){return!!this.isSelectedItemOk(a)&&(this._prepareSearch(),this.results=[],this.selectedItem=a,this.inputValue=a.title,this.selectedItem)},d.prototype.setSelectedItem=function(a){return this.isSelectedItemOk(a)||(a=this._normalizeItem(a)),this._selectItem(a)},d.prototype.selectItemByIndex=function(a){a=void 0===a?this.activeIndex:a,this.setActiveIndex(a),this.activeIndex>-1?this._selectItem(this.results[this.activeIndex]):(this.selectedItem=void 0,this.inputValue=""),this.results=[],void 0!==this.options.callbackOnSelect&&this.options.callbackOnSelect(this.selectedItem)},d.prototype.isSelectedItemOk=function(a){var b=a||this.selectedItem;return b&&void 0!==typeof b.id&&!!b.title},d.prototype.getModelViewValue=function(){return this.selectedItem&&this.selectedItem[a(this.options)]},d.prototype.unsetActiveIndex=function(){this.activeIndex=-1},d.prototype.setActiveIndex=function(a){var b=this.results.length;this.activeIndex=0===b?-1:a<-1||a>=b?0:-1===a?b-1:a},d}])}(),function(){"use strict";angular.module("clientWww.common.directives.estPreventPaste",[]).directive("estPreventPaste",[function(){return{restrict:"A",link:function(a,b){b.bind("paste",function(){return!1})}}}])}(),function(){"use strict";angular.module("clientWww.common.directives.estHeaderStepScroll",["ui.router"]).directive("estHeaderStepScroll",["$location","$state",function(a,b){return{restrict:"A",scope:{type:"@"},link:function(c,d){function e(){var b=a.$$path,c=0,e={};b=b.split("/")[2],$(".steps").find(".progress-step:not(.title)").each(function(){var a=$(this).find(">:last-child"),b=$(this).outerWidth();if(e[a.text().toLowerCase()]=c,c+=b,6===Object.keys(e).length)return!1}),d.animate({scrollLeft:e[b]},10)}function f(){var a=0,c=b.$current.data.stepNumber;angular.element(".steps").find(".progress-step:not(.title)").each(function(){var b=$(this).outerWidth();if(1===c)return!1;a+=b}),d.animate({scrollLeft:a},10)}switch(c.type){case"nonReturnable":f();break;case"returnable":default:e()}}}}])}(),function(){"use strict";function a(a,b,d,e){var f=this,g=this.scope=b;this.$timeout=e,this.copy={dropYourFile:"Drop your file here",uploadText:"Uploading"},this.options=_.merge({},c,b.multidocOptions),this.uploader=b.uploader,this.happinessModal=a,this._inputElement=d.find("input")[0];var h=this.uploader.hookOnCompleteSuccess;this.uploader.hookOnCompleteSuccess=function(a,c){if(g.uploadedfiles&&g.uploadedfiles.push(c.id),b.fileCollection.add(c),f._onCollectionChange(),h)return h.apply(this,arguments)},this._onCollectionChange()}var b=angular.module("clientWww.common.directives.estMultidocUpload",["clientWww.files.fileCollection","clientWww.common.upload.uploader"]),c={canDelete:!0};a.prototype._onCollectionChange=function(){var a=this.$timeout,b=this.scope;b.$evalAsync(function(){return a(function(){b.estDynamicHeight&&b.estDynamicHeight.refreshHeight()})})},a.prototype.openBrowse=function(){$(this._inputElement).val(""),this._inputElement.click()},a.prototype.upload=function(){this.uploader.uploadItem()},a.prototype.deleteFile=function(a){var b=this;return this.scope.fileCollection.delete(a).then(function(){b._onCollectionChange()})},a.prototype.getClassForProgress=function(){return this.uploader.isInProgress()?"progress-active":this.uploader.isSuccessful()?"progress-success":this.uploader.hasAnError()?"progress-warning":""},b.controller("EstMultidocUploadController",["clientHappinessModal","$scope","$element","$timeout",a]),b.directive("estMultidocUpload",[function(){return{restrict:"E",transclude:!0,templateUrl:"/common/directives/est-multidoc-upload.html",require:"?^estDynamicHeight",scope:{uploader:"=",multidocOptions:"=",fileCollection:"="},replace:!0,controller:"EstMultidocUploadController",controllerAs:"multidoc",link:function(a,b,c,d){a.estDynamicHeight=d}}}])}(),function(){"use strict";var a=angular.module("clientWww.common.directives.estUnsavedForm",[]);a.service("unsavedWarningSharedService",["$rootScope","$window",function(a,b){function c(){b.onbeforeunload=e.confirmExit}function d(){return g=!_.some(f,"$dirty")}var e=this,f=[],g=!0,h=0;this.init=function(a){0===f.length&&c(),f.push(a)},a.$on("$stateChangeStart",function(){f=[]}),this.updateActivity=function(a){e.lastUpdated=a,h++},this.confirmExit=function(){var a=moment().subtract(5,"minutes"),c=e.lastUpdated.isAfter(a);if(!d()&&c&&h>1)return"You have some unsaved information on this page that will be lost if you leave.";b.onbeforeunload=null,f=[]}}]),a.directive("estUnsavedForm",["unsavedWarningSharedService",function(a){return{scope:{},require:"^form",link:function(b,c,d,e){a.init(e),a.updateActivity(moment()),c.bind("submit",function(a){e.$valid&&e.$setPristine()}),c.bind("change",function(b){a.updateActivity(moment())})}}}])}(),function(){"use strict";var a=angular.module("clientWww.common.directives.estSignOutBanner",[]);a.directive("estSignOutBanner",[function(){return{restrict:"E",templateUrl:"/common/directives/est-sign-out-banner.html",controller:"SignOutBannerController"}}]),a.controller("SignOutBannerController",["$rootScope","$scope","$timeout","userModel",function(a,b,c,d){function e(a){b.showBanner=a,a?$("body").addClass("sign-out-banner-body"):$("body").removeClass("sign-out-banner-body")}function f(){b.timeLeft=Math.max(b.timeLeft-1,0),i.secondCountDown=c(f,1e3)}function g(){i.secondCountDown&&c.cancel(i.secondCountDown)}function h(){f(),e(!0)}var i=this;b.showBanner=!1,b.timeLeft=60,a.$on("show-sign-out-banner",function(a,d){b.showBanner||(b.timeLeft=d.timeLeft?Math.round(d.timeLeft/1e3):60,c(h,d.delay))}),a.$on("$locationChangeStart",function(){b.showBanner&&(g(),e(!1))}),b.staySignedIn=function(){g(),e(!1),d.refreshAuth()}}])}(),function(){"use strict";var a=angular.module("clientWww.common.directives.estTaxDocumentBanner",["clientWww.common.taxDocumentHelper"]);a.directive("estTaxDocumentBanner",[function(){return{restrict:"E",templateUrl:"/common/directives/est-tax-document-banner.html",scope:{loanList:"=loanList"},controller:"TaxDocumentBannerController"}}]),a.controller("TaxDocumentBannerController",["ipCookie","$scope","STUDENT_LOAN_TYPES","loanServicerIntegrationService","$window","pageAlerts","NAVIENT_ERROR_MESSAGES","Loan","taxDocumentHelper",function(a,b,c,d,e,f,g,h,i){b.showTaxBanner=!1;var j=function(){i.listHasAnActiveLoanDuring(b.loanList,2020).length>0&&!a("hideTaxDocumentBanner")&&(b.showTaxBanner=!0)};b.CloseTaxBanner=function(){b.showTaxBanner=!1,a("hideTaxDocumentBanner",!0,{expires:7,path:"/"})},b.goToDetailPage=function(){var a=i.listHasAnActiveLoanDuring(b.loanList,2020),c=a[0].id;return d.getLoanServicerApplicationUrl(c,"slr").then(function(a){if(a)return void(e.location.href=a)}).catch(function(a){f.addAlert("error",g.whitelabel_redirect_failed)})},b.goToTaxFormsFaq=function(){e.location.href="https://help.earnest.com/hc/en-us/articles/360041088294-FAQ-Tax-Forms-1098-E-1099-MISC-"},j()}])}(),function(){"use strict";var a=angular.module("clientWww.common.directives.estCovidHelpBanner",[]);a.directive("estCovidHelpBanner",[function(){return{restrict:"E",templateUrl:"/common/directives/est-covid-help-banner.html",controller:"CovidHelpBannerController"}}]),a.controller("CovidHelpBannerController",["ipCookie","$scope",function(a,b){b.showCovidHelpBanner=!1;var c=function(){a("hideCovidHelpBanner")||(b.showCovidHelpBanner=!0)};b.CloseCovidHelpBanner=function(){b.showCovidHelpBanner=!1,a("hideCovidHelpBanner",!0,{expires:7,path:"/"})},c()}])}(),function(){"use strict";angular.module("clientWww.common.profile",["clientWww.common.profile.ui-education.education","clientWww.common.profile.ui-employment.employment","clientWww.common.profile.ui-financial.financial","clientWww.common.profile.ui-financial.asyncCreateFinancialAccountModal","clientWww.common.profile.ui-financial.asyncInstitutionConnectChallengeModal","clientWww.common.profile.ui-personal.personal","clientWww.common.profile.ui-add-cosigner.add-cosigner","clientWww.common.profile.ui-complete.complete","clientWww.common.profile.common.profileWidget","clientWww.common.profile.common.helpSidebar","clientWww.common.profile.common.profileHeader","clientWww.common.profile.ui-financial.estAsyncLinkedAccounts","clientWww.common.profile.ui-financial.estPlaidLink","clientWww.common.profile.common.profileWidget"])}(),function(){"use strict";angular.module("clientWww.common.directives.estReplaceInputWithDots",[]).directive("estReplaceInputWithDots",[function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){window.getComputedStyle(b[0]).webkitTextSecurity||(b[0].type="password")}}}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-education.education",["clientWww.common.directives.estAutocomplete","clientWww.common.pageAlerts","clientWww.loans.loansModel"]).controller("ProfileEducationController",["$scope","$q","$filter","ProfileErrorMessages","educationModel","AutocompleteSearch","QuickRateScoreModel","constants","pageAlerts","Loan","linkedInLoader","userModel","profileHelpers","initModels","analytics","$exceptionHandler","navigationModel","optimizelyService","Cobranded","LOAN_CONSTANTS","$window","estimate",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){function w(){return"student_loan_refinance"===j.attributes.data.type&&e.hasGraduateDegree()&&!e.hasUndergradDegree()}function x(){var a=j.isStudentLoanOrigination()&&!j.isUndergrad();return _.all([!e.hasHigherEducation(),"student_loan_refinance"===j.attributes.data.type||a,"child"!==_.get(j,"attributes.data.misc.whose_education")])}function y(){return"student_loan_refinance"===j.attributes.data.type&&e.hasCurrentOrFutureNotEndingSoon()}a.educations=e,a.errorMessages=d.educations,a.degree_types=h.getVersionedDegrees(),a.degree_version=h.getLatestDegreeVersion(),a.isEducationEmpty=0===e.data.length,a.userModel=l,a.loadingLinkedIn=!1,a.Loan=j,a.loanData=j.attributes.data,a.showEducationForm=!a.isEducationEmpty,a.isCobranded=s.isTurboTaxClient(),a.minStudentLoanAmount=t.studentRefiMinAmountRequested,a.maxStudentLoanAmount=t.studentRefiMaxAmountRequested,a.refinanceAmountErrorMessages={required:"Please enter your approximate amount to refinance.",min:"The minimum amount to refinance is "+c("estCurrency")(a.minStudentLoanAmount,"$")+".",max:"Please enter a lower amount."},a.displayLinkedIn=k.isDeviceSupported()&&0===l.attributes.data.completed_application_count&&!l.attributes.data.linkedin_id,this.profileHelpers=m,this.initModels=n,this.userModel=l,this.$exceptionHandler=p,this.pageAlerts=i,this.IN={},this.linkedinIsAuthorized=!1;var z=this,A={id:"id",title:"name"};a.displayLinkedIn&&(a.loadingLinkedIn=!0,k.initLinkedin().then(function(){a.loadingLinkedIn=!1,z.IN=window.IN}).catch(function(){a.displayLinkedIn=!1}));var B=function(a){return new f(function(b){a&&b.title===this.inputValue&&(b.id=a);var c,d={};return _.each(b,function(a,e){c=A[e]||e,d[c]=b[e]}),g.getSchools(d).then(function(a){return _.map(a.data,function(a){return{id:a[A.id],title:a[A.title],subtitle:a.city+", "+(a.state||a.country)}})})},{resultsTitle:"Universities & Colleges",noResultsFoundMsg:"School not found.",allowManualInput:!0,ngModelUsesTitle:!0,callbackOnSelect:function(a){a&&_.each(e.data,function(b){var c=b.autocompleteSearch.selectedItem;c&&a.title===c.title&&(b.school_id=-1!==c.id?c.id:null,b.school_name=c.title)})}})};this._onLinkedInAuth=function(){return a.loadingLinkedIn=!0,z.linkedinIsAuthorized=!0,k.getRawData(z.IN.API,z.userModel).then(function(){return z.profileHelpers.connectLinkedIn(z.userModel.rawProfile).catch(function(a){z.$exceptionHandler(a),z.pageAlerts.addAlert("error","Unfortunately, there was a problem importing your LinkedIn profile information. Please enter in your details manually.")})}).then(function(){return a.displayLinkedIn=!1,n.initBasicProfile()}).then(function(){return q.completeState("start",{force:!0})}).then(function(){_.each(e.data,function(a){a.autocompleteSearch=B()})})},a.openLinkedInModal=function(){a.loadingLinkedIn||(o.track("open linkedin modal"),$(".IN-widget a").parent().click(),window.IN.Event.on(window.IN,"auth",function(){z.linkedinIsAuthorized||z._onLinkedInAuth()}))},_.each(e.data,function(a){var b=a.school_id;a.autocompleteSearch=B(b)}),a.hideMarketplaceBanner=!1,a.showMarketplaceBanner=function(){var b=u.document.referrer,c=u.browserifyScripts.qs,d=c.parse(b),e=d.estimateId;return _.all([e,!a.hideMarketplaceBanner])},a.dismissMarketplaceBanner=function(){a.hideMarketplaceBanner=!0};var C=_.round(moment.duration(a.loanData.term,"days").asMonths()),D=_.get(l,"attributes.data.first_name"),E=D&&_.startCase(D.toLowerCase()),F=_.chain(v).result("rates").find({term_months:C}).result("rates").findWhere({rate_type:"fixed"}).result("rate").value();a.marketplaceEstimateDetails={firstName:E,rate:F,rateType:"fixed"},a.clearLocalEducations=function(){e.data=[]},a.addEducation=function(){e.addItem(0),e.data[0].autocompleteSearch=B()},a.educationSaveAndGo=function(){if("student_loan_refinance"===j.attributes.data.type&&r.trackEvent("SLREducationClickedCTA"),w())i.addErrorAlert("Before continuing, please add details about your undergraduate education.",7e3);else if(x())i.addErrorAlert("At least one completed or in progress degree is required to proceed.",7e3);else{if(!y()){var b=Array.prototype.slice.call(arguments);return a.saveAndGo.apply(a,b)}i.addErrorAlert("At this time, Earnest is only able to refinance student loans for half-time and full-time students who are within 6 months of graduating. We hope you will consider us in the future.",15e3)}},a.cosignerEducationSaveAndGo=function(){var b=Array.prototype.slice.call(arguments);return a.saveAndGo.apply(a,b)},a.displayParentPlus=function(){return j.isStudentLoanRefinance()&&"mine"!==j.attributes.data.misc.whose_education&&!a.isCobranded},a.isEducationOptional=function(){return!a.showEducationForm&&a.Loan.isStudentLoanOrigination()&&a.Loan.isCurrentApplicantThePrimary()&&a.Loan.isUndergrad()},a.isSLO=function(){return j.isStudentLoanOrigination()&&j.isUndergrad()},a.$watch(function(){a.isEducationEmpty=0===e.data.length,a.showEducationForm=!a.isEducationEmpty;var b=a.Loan.isStudentLoanOrigination()&&a.Loan.isCurrentApplicantThePrimary()&&a.Loan.isUndergrad();a.showFormAlert=b&&!a.isEducationEmpty})}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-employment.employment",["clientWww.common.profile.ui-employment.verifyEmploymentModal","clientWww.common.profile.ui-employment.verifyGraduationEmploymentModal","clientWww.common.profile.ui-employment.addFutureEmploymentModal","clientWww.common.profile.ui-employment.addPreviousWorkHistoryModal","clientWww.common.profile.ui-employment.fillInWorkDetailsModal","clientWww.common.pageAlerts","clientWww.loans.loansModel","clientWww.quickRateScore.model","ui.router"]).controller("ProfileEmploymentController",["$scope","ProfileErrorMessages","employmentModel","userModel","educationModel","verifyEmploymentModal","verifyGraduationEmploymentModal","addFutureEmploymentModal","addPreviousWorkHistoryModal","fillInWorkDetailsModal","pageAlerts","saveProfileAndGo","redirect","Loan","$location","optimizelyService","QuickRateScoreModel","SSO","CONFIG",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){a.clearLocalEmployment=function(){c.data=[]},a.addEmployment=function(){c.addItem()},a.isSLOGrad=function(){return n.isStudentLoanOrigination()&&n.isGrad()},a.isSLO=function(){return n.isStudentLoanOrigination()},a.isEmploymentOptional=function(){return n.isStudentLoanOrigination()&&n.isCurrentApplicantThePrimary()&&!n.isParent()};var t=function(){return{locals:{onContinuePromiseGetter:function(){return l(a)},newFutureEmployment:c.addFutureEmployer.bind(c)}}},u=function(){return g.open(_.assign(t(),{locals:{onSignoutPromiseGetter:function(){return d.logout().then(function(){r.ssoRedirectLogout("/")})}}}))},v=function(){return f.open(t())},w=function(){return h.open(t())},x=function(){return i.open(_.assign(t(),{locals:{onContinuePromiseGetter:function(){return l(a)},addPreviousEmployer:c.addPreviousEmployer.bind(c)}}))};a.lessThanThreeYearsWorkExperience=function(){var b=c.getOldestEmployment();if(a.employments.data.length<=0||!_.get(b,"start_date.month"))return!0;b=moment({month:b.start_date.month-1,year:b.start_date.year});var d=e.earliestCompletedEducationEndDate(),f=d&&moment({month:d.month-1,year:d.year});return!(b.isBefore(moment().subtract(3,"years"))||b.isBefore(f.add(12,"months")))};var y=function(){return j.open(t())};a.verifyGraduationAndEmployment=function(){if(a.isEmploymentOptional()){if(q.hasFutureIncome()&&!a.hasFutureEmployer)return w();if(q.hasStatedIncome()&&!c.hasTwoPlusYearsWorkExperience())return x();if(c.hasMissingStartDates())return y()}return!e.hasCurrent()||a.isEmploymentOptional()||a.hasFutureEmployer||a.hasCurrentEmployer?a.isEmploymentOptional()||!c.isFutureEmploymentRequired()||a.hasFutureEmployer?("student_loan_refinance"===n.attributes.data.type&&p.trackEvent("SLREmploymentClickedCTA"),l(a)):v():u()},a.checkEmploymentHistory=function(){if(a.showPageAlert){var b;b=a.lessThanThreeYearsWorkExperience()&&a.insufficientEmployment?"Please confirm that you have under three years of work experience or add more employment years. If you are not currently employed, please provide an explanation and at least one past employer. Otherwise, add a current or future employer to continue.":a.lessThanThreeYearsWorkExperience()&&!a.insufficientEmployment?"You've entered less than three years of employment. Please confirm that you have less than three years of work experience or add more employment years to continue":"If you are not currently employed, please provide an explanation and at least one past employer. Otherwise, add a current or future employer to continue.",k.addErrorAlert(b,12e3)}},a.verifyEmployment=function(){return c.isFutureEmploymentRequired()&&!a.hasFutureEmployer?v():l(a,"profile.financial")},n.isStudentLoanRefinance()||n.isPersonalLoan()||c.addInternshipType(),
a.no_employment=!!d.attributes.data.misc.others.unemployment_reason,a.low_employment=!!d.attributes.data.misc.others.employment_experience_reason,a.isEmploymentEmpty=0===c.data.length,a.employments=c,a.hasNewJobExpenses=n.hasNewJobExpenses(),a.others=d.attributes.data.misc.others,a.errorMessages=b.employments,a.hideOrShowInfoBox=!(a.employments.data.length>0&&o.$$absUrl.indexOf("dashboard")>0);var z=function(){var a=s.featureFlags.medicalResidencyEnabled,b=["DDS","DO","MD","DVM","PharmD"],c=_.map(e.data,"structured_degree");c.push(q.attributes.degree_type);var d=_.intersection(c,b).length>0;return a&&d&&n.isStudentLoanRefinance()},A=function(){var b=q.attributes.residency_end_date&&moment(q.attributes.residency_end_date),d=b&&b.isBefore(moment()),e=_.first(a.employments.data);e&&!e.isItemComplete&&(e.type=c.Types.MEDICAL_RESIDENCY,e.end_date={month:b&&b.month()+1,year:b&&b.year()},e.status=d?c.Statuses.PREVIOUS:c.Statuses.CURRENT)};z()&&A(),a.shouldPrepopulateMedicalResidency=z,a.prepopulateMedicalResidency=A,a.$watch(function(){a.hasCurrentEmployer=c.hasCurrentEmployer(),a.hasFutureEmployer=c.hasFutureEmployer(),a.isEmploymentEmpty=0===c.data.length,a.insufficientEmployment=!a.hasCurrentEmployer&&!a.hasFutureEmployer&&(!a.employments.data.length>0||!(a.others.unemployment_reason||a.others.employment_experience_reason)),a.showFormAlert=a.isEmploymentOptional()&&a.insufficientEmployment,a.showPageAlert=!a.isEmploymentOptional()&&(a.insufficientEmployment||a.lessThanThreeYearsWorkExperience())})}])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.ui-employment.verifyEmploymentModal",[]);a.factory("verifyEmploymentModal",["EstModalFactory",function(a){return new a({name:"verify-employment-modal",templateUrl:"/common/profile/ui-employment/verify-employment-modal.html",controller:"VerifyEmploymentModalController as detail"})}]);var b=function(a,b){a.closeAndContinue=function(){return b.all([a.close(),a.onContinuePromiseGetter()])},a.closeAndStay=function(){return b.all([a.close(),a.newFutureEmployment()])}};a.controller("VerifyEmploymentModalController",["$scope","$q",b])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.ui-employment.verifyGraduationEmploymentModal",[]);a.factory("verifyGraduationEmploymentModal",["EstModalFactory",function(a){return new a({name:"verify-graduation-employment-modal",templateUrl:"/common/profile/ui-employment/verify-graduation-employment-modal.html",controller:"VerifyGraduationEmploymentModalController as detail"})}]);var b=function(a,b){a.closeAndSignout=function(){return b.all([a.close(),a.onSignoutPromiseGetter()])},a.closeAndStay=function(){return b.all([a.close(),a.newFutureEmployment()])}};a.controller("VerifyGraduationEmploymentModalController",["$scope","$q",b])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-employment.addFutureEmploymentModal",["common.ui.modal"]).factory("addFutureEmploymentModal",["EstModalFactory",function(a){return new a({name:"add-future-employment-modal",templateUrl:"/common/profile/ui-employment/add-future-employment-modal.html",controller:"AddFutureEmploymentController as ctrl"})}]).controller("AddFutureEmploymentController",["$scope","$q",function(a,b){a.closeAndContinue=function(){return b.all([a.close(),a.onContinuePromiseGetter()])},a.closeAndStay=function(){return b.all([a.close(),a.newFutureEmployment()])}}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-employment.addPreviousWorkHistoryModal",["common.ui.modal"]).factory("addPreviousWorkHistoryModal",["EstModalFactory",function(a){return new a({name:"add-previous-work-history-modal",templateUrl:"/common/profile/ui-employment/add-previous-work-history-modal.html",controller:"AddPreviousWorkHistoryController as ctrl"})}]).controller("AddPreviousWorkHistoryController",["$scope","$q",function(a,b){a.closeAndContinue=function(){return b.all([a.close(),a.onContinuePromiseGetter()])},a.closeAndStay=function(){return b.all([a.close(),a.addPreviousEmployer()])}}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-employment.fillInWorkDetailsModal",["common.ui.modal"]).factory("fillInWorkDetailsModal",["EstModalFactory",function(a){return new a({name:"fill-in-work-details-modal",templateUrl:"/common/profile/ui-employment/fill-in-work-details-modal.html",controller:"FillInWorkDetailsModal as ctrl"})}]).controller("FillInWorkDetailsModal",["$scope","$q",function(a,b){a.closeAndContinue=function(){return b.all([a.close(),a.onContinuePromiseGetter()])},a.closeAndStay=function(){return b.all([a.close()])}}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-financial.financial",["clientWww.common.profile.ui-financial.verifyAssetsModal","clientWww.common.services.plaidLink","ui.router"]).controller("ProfileFinancialController",["$q","$scope","institutionConnectPopularInstitutionsModel","$state","loadPromise","pageAlerts","profileYesNoOptions","ProfileErrorMessages","assetModel","incomeModel","financialAccountModel","employmentModel","userModel","QuickRateScoreModel","verifyAssetsModal","saveProfileAndGo","EmploymentCalc","$location","Loan","optimizelyService","estLocalStorage","institutionConnectRequestModel","plaidLinkService","usePlaidLink","userValidationRedirect","analytics","flagger","FLAG_NAMES",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B){function C(a){var c=_.find(b.incomes.data,function(b){return"bonuses"===b.type&&b.employment_id===a.id});c||(c=b.incomes.data.push({type:"bonuses",employment_id:a.id,value:void 0})),a.income_title=a.company_name,"future"===a.status&&(a.income_title+=" Future"),a.income_title+=" Income"}function D(){return _.any(b.employmentList,function(a){return"future"===a.status})}function E(){return s.isPersonalLoan()&&!!b.hasValidAccount&&A.getTest(B.connect_routing_number_pl).hasVariation("enabled")}b.assets=i,b.incomes=j,b.employments=l,b.others=m.attributes.data.misc.others,b.profileYesNoOptions=g,b.financial_accounts=k,b.errorMessages=h,b.isPersonalLoan=s.isPersonalLoan(),b.usePlaidLink=x,b.userValidationRedirect=y,b.linkableAccounts=k.paymentAccounts(),b.openPlaidLink=function(){w.open()},v.getUnsuccessfulRequests(),b.isSLOUndergrad=s.isUndergrad(),b.isCosigner=s.isCurrentApplicantACosigner(),b.isSLOStudent=s.isSLOStudent()&&!b.isCosigner;var F;if(b.isSLOStudent){var G=s.attributes.data.degree_start_date,H=l.getSLOStudentImportantEmployers(G);switch(H.type){case"future":F="future",b.sloStudentIncomeTitle="Future Annual Income";break;case"current":F="current",b.sloStudentIncomeTitle="Annual Income";break;case"previous":F="previous",b.sloStudentIncomeTitle="Most Recent Annual Income";break;default:b.sloStudentIncomeTitle="Annual Income"}b.employmentList=H.employment}else b.employmentList=l.getCurrentAndFutureEmployers();_.forEach(b.employmentList,C),b.hideOrShowInfoBox=!(b.financial_accounts.data.length>0&&r.$$absUrl.indexOf("dashboard")>0||b.usePlaidLink),k.startPoling(),b.$watch("incomes.data.length",function(){_.forEach(b.incomes.data,function(a,b){a.actual_index=b})}),b.$watch("[incomes.data, employments.data]",function(){var a=_.map(b.employmentList,"id"),c=_.filter(b.incomes.data,function(b){return!b.employment_id||_.includes(a,b.employment_id)}),d=new q(b.employmentList,c);if(b.isSLOStudent)switch(F){case"future":b.total_income_display=d.totalFutureIncome();break;case"current":b.total_income_display=d.totalCurrentIncome();break;case"previous":var e=moment(G).subtract(1,"years"),f=moment().diff(e,"months");b.total_income_display=d.totalPreviousIncome(f);break;default:b.total_income_display=0}else b.total_income_display=D()?d.totalFutureIncome():d.totalCurrentIncome()},!0),b.$watch("assets.data",function(){for(var a=0,c=0;c<b.assets.data.length;c++)a+=parseInt(b.assets.data[c].value,10)||0;b.total_assets=a},!0),b.$watch("financial_accounts.data",function(){b.showLinkAccount||(b.linkableAccounts=k.paymentAccounts()),b.hasValidAccount=k.hasValidAccount(),b.showLinkAccount=E()},!0),b.addIncome=function(){b.financial_form&&b.financial_form.incomes_form&&b.financial_form.$invalid&&b.financial_form.incomes_form.$setPristine();var a=j.data.length;j.addItem(a),j.data[a].actual_index=a},b.addAsset=function(){b.financial_form&&b.financial_form.assets_form&&b.financial_form.$invalid&&b.financial_form.assets_form.$setPristine(),i.addItem(i.data.length)},b.deleteIntuitAccount=function(){var a=k.deleteAllFinancialAccounts().then(function(){f.addAlert("success","All set. Live long and prosper."),k.refreshFinancialAccounts()});return e(b,a,f)},b.verifyAssets=function(){var a=k.sumAssetAccounts(),c=a+b.total_assets,d=n.attributes.stated_savings,e=_(b.employments.getFutureEmployers()).map("salary").reduce(function(a,b){return a+b},0);return c<.9*d||b.isSLOUndergrad&&n.attributes.future_income>e?o.open({locals:{stated_savings:d,totalBankAndAdditional:c,onContinuePromiseGetter:function(){return"student_loan_refinance"===s.attributes.data.type?t.trackEvent("SLRFinancialClickedCTA"):"student_loan_origination"===s.attributes.data.type&&t.trackEvent("SLOFinancialClickedCTA"),p(b)}}}):("student_loan_refinance"===s.attributes.data.type?t.trackEvent("SLRFinancialClickedCTA"):"student_loan_origination"===s.attributes.data.type&&t.trackEvent("SLOFinancialClickedCTA"),p(b))},b.savePLFinancial=function(){if(b.showLinkAccount&&b.isLinkAccountEditable){var a=b.linkableAccounts,c=a[a.selectedIndex],d=s.associateBankAccount({financial_account_id:c.id,routing_number:c.routing_number,account_number:c.account_number});return e(b,d,f).then(function(){return p(b)})}return p(b)},b.shouldDisplayIncomeTotal=function(){var a=_.any(b.employmentList,function(a){return"current"===a.status&&a.misc&&a.misc.ending_soon});return!D()||!a},b.shouldDisplayExtraIncomeHeader=function(){return _.filter(b.incomes.data,function(a){return!a.employment_id}).length>0},b.getEmploymentBonus=function(a){return _.find(b.incomes.data,function(b){return b.employment_id===a})},b.markDataAsDirty=function(a){a.isDirty=!0},b.hideIncomeSection=function(){var a=!(b.employments.hasFutureEmployer()||b.employments.hasCurrentEmployer()||b.employments.hasPreviousEmployer());return b.isSLOUndergrad&&a},b.isFinancialDashboard="dashboard.profile.financial"===d.current.name,b.deleteEmptyIncome=function(){j.data=_.reject(j.data,function(a){return _.isUndefined(a.value)&&_.isUndefined(a.type)})},b.checkValidAccount=function(){k.hasValidAccount()?(b.showCheckingInLineAlert=!1,b.hasValidAccount=!0):(z.track("Error: Connect a Financial Account Before Proceeding"),b.showCheckingInLineAlert=!0,b.hasValidAccount=!1)},b.showLinkAccount=E(),b.submit=function(){this.deleteEmptyIncome(),b.usePlaidLink&&this.checkValidAccount()},b.minimumSalary=function(a){return b.minimumSalaryInlineError=a<=1e4&&a>=500,b.minimumSalaryInlineError},b.showLinkAccountEditSaveButtons=null!==s.attributes.data.bank_account,b.isLinkAccountEditable=!b.showLinkAccountEditSaveButtons,b.editDirectDeposit=function(){var a=b.linkableAccounts&&b.linkableAccounts[b.linkableAccounts.selectedIndex];a.routing_number="",a.account_number="",a.verify_account_number="",b.isLinkAccountEditable=!0}}])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.ui-financial.asyncCreateFinancialAccountModal",[]);a.factory("asyncCreateFinancialAccountModal",["EstModalFactory",function(a){return new a({name:"async-create-financial-account-modal",templateUrl:"/common/profile/ui-financial/async-create-financial-account-modal.html",controller:"AsyncCreateFinancialAccountController as create"})}]);var b=function(a,b,c,d,e,f,g){function h(){var b=a.financial_account_form.$submitted;a.onClose&&a.onClose(b)}a.canClose=!0,a.openedFromError=a.openedFromError||!1,a.accountData=a.accountData||{},a.institutionData=a.institutionData||{},a.type=a.type||"add_account",a.isAddAnother="add_another"===a.type;var i=a.institutionData.name||a.accountData.institution_name,j=function(){switch(a.type){case"add_another":return'Add Another "'+i+'" Account';case"manual_add_account":return'Add a "'+i+'" Account';default:return"Add a Financial Account"}};a.getModalTitle=j();var k={type:"",institution_name:i,balance:"",institution_id:a.accountData.institution_id||a.institutionData.id,id:a.accountData.id,misc:{},isDirty:!0},l=["credit_card","loan"],m={checking:{name:"Checking",type:"banking"},savings:{name:"Savings",type:"banking"},cd:{name:"CD",type:"banking"},credit_card:{name:"Credit Card",type:"credit_card"},line_of_credit:{name:"Line of Credit",type:"loan"},home_equity:{name:"Home Equity Line of Credit",type:"loan"},auto_loan:{name:"Auto Loan",type:"loan"},mortgage:{name:"Mortgage",type:"loan"},personal_loan:{name:"Personal Loan",type:"loan"},student_loan:{name:"Student Loan",type:"loan"},retirement:{name:"401k / IRA/ Retirement",type:"investment"},brokerage:{name:"Brokerage",type:"investment"}};a.accounts=[],a.addAccount=function(){a.accounts.push(_.cloneDeep(k))},a.deleteItem=function(){a.accounts.splice(this.$index,1)},a.closeModal=function(){a.canClose=!0;var c=e.when();return a.isAuthRequired&&(c=b.deleteItem(a.accountData.id)),c.then(function(){return b.refreshFinancialAccounts()}).then(function(){a.close(),h()})},a.addAccount(),a.submit=function(){return _.each(a.accounts,function(a){_.contains(l,m[a.type].type)&&(a.balance*=-1),a.name=m[a.type].name,a.misc.sub_type=a.type,a.misc.institution_name=a.institution_name,a.type=m[a.type].type}),c(a,b.batchSave(a.accounts)).then(function(){return _.map(_.uniq(a.accounts,"institution_name"),function(a){var b={Location:g.current.name,"Institution Name":a.institution_name,"Account Type":a.type,Amount:a.balance};f.track("Create Manual Account",b)}),a.accounts=[],b.refreshFinancialAccounts()}).then(function(){return d.addAlert("success","Success! Your account was added. Please upload your account statements, along with any other required documents, at the end of the next section."),a.canClose=!0,h(),a.close()})}};a.controller("AsyncCreateFinancialAccountController",["$scope","financialAccountModel","loadPromise","pageAlerts","$q","analytics","$state",b])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.ui-financial.asyncInstitutionConnectChallengeModal",[]);a.factory("asyncInstitutionConnectChallengeModal",["EstModalFactory",function(a){return new a({name:"async-institution-connect-challenge-modal",templateUrl:"/common/profile/ui-financial/async-institution-connect-challenge-modal.html",controller:"AsyncInstitutionConnectChallengeController as connect"})}]);var b=function(a,b,c,d,e){function f(){return a.instConn.challengeModel.submitChallengeResponses(a.financialAccountId,a.instConn.authModel.data.id).then(function(b){return b&&b.mfa?a.instConn.challengeModel:a.instConn.institutionConnectManager.successfulAccountConnection(b.data)}).catch(function(b){e.track("Unable to Validate Financial Institution MFA",{"Institution ID":a.instConn.authModel.data.id,"Institution Name":a.instConn.authModel.data.name});var c={408:"This security question has expired. Please re-enter your account credentials to get a new question."},d=c[b.status]||_.get(b,".data.message")||b.message;if(b.message=d,b.data.message=d,b.status>=400)return a.instConn.institutionConnectManager.errorInConnection(b)})}a.financialAccountId=a.instConn.institutionConnectManager.currentFinancialAccountId,a.challengeModel=a.instConn.challengeModel,a.challengeModel.data.challenge_response=[],a.submitChallenge=function(){if(e.track("Clicked Submit MFA Challenge",{"Institution Name":a.instConn.authModel.data.name,"Institution ID":a.instConn.authModel.data.id}),!a.loading)return a.connect_accounts_challenge_form.$setSubmitted(!0),a.connect_accounts_challenge_form.$valid?a.instConn.localLoadPromise(f()).then(function(b){return a.instConn.challengeModel.updateModelFromResponse(b),c.addAlert("success","Success! Your account was added."),a.canClose=!0,a.close()}).catch(function(b){var c=b.status||_.get(b,".data.status");a.instConn.alerts.addAlert("error",b.message||b,void 0,c)}):void 0},a.closeModal=function(){a.canClose=!0,a.close(),a.onClose&&a.onClose()}};a.controller("AsyncInstitutionConnectChallengeController",["$scope","financialAccountModel","pageAlerts","$q","analytics",b])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.ui-financial.verifyAssetsModal",[]);a.factory("verifyAssetsModal",["EstModalFactory",function(a){return new a({name:"verify-assets-modal",templateUrl:"/common/profile/ui-financial/verify-assets-modal.html",controller:"VerifyAssetsModalController as detail"})}]);var b=function(a,b){a.closeAndContinue=function(){b.all([a.close(),a.onContinuePromiseGetter()])},a.closeAndStay=function(){a.close()}};a.controller("VerifyAssetsModalController",["$scope","$q",b])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-financial.estPlaidLink",["clientWww.user.userModel"]).controller("PlaidLinkController",["$scope","financialAccountModel","plaidLinkService","userModel","flagger","FLAG_NAMES","Loan",function(a,b,c,d,e,f,g){var h=this;a.accounts=b.data,this.user=d,this.connectedInstitutions=[],this.hasAccounts=!1,this.reconnect=function(a){c.reconnect(a)};var i=e.getTest(f.user_validation_pl).hasVariation("enabled")&&g.isPersonalLoan()&&!this.user.attributes.data.can_connect_accounts,j=e.getTest(f.user_validation).hasVariation("enabled")&&g.isStudentLoanRefinance()&&!this.user.attributes.data.can_connect_accounts;this.showAddAccountManually=i||j||c.userEncounteredError(),a.$watchCollection("accounts",function(){h.connectedInstitutions=_.indexBy(a.accounts,"institution_name"),h.hasAccounts=a.accounts.length>0}),a.$watch(function(){return b.isRefreshingAccounts},function(){a.loading=b.isRefreshingAccounts}),this.openManualAddAccountModal=c.openManualAddAccountModal}]).directive("estPlaidLink",["financialAccountModel","analytics","userModel","flagger","FLAG_NAMES",function(a,b,c){return{restrict:"AE",controller:"PlaidLinkController as plaidLink",templateUrl:"/common/profile/ui-financial/est-plaid-link.html",require:"^form",scope:!0}}])}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){return _.reduce(a,function(a,b){var c=b.errorCodes||[],d=_.times(c.length,_.constant(b.message));return _.assign({},a,_.zipObject(c,d))},{})}function i(a){return _.sortBy(a,"sub_type").reduce(function(a,b){var c=_.find(a,{institution_name:b.institution_name});return c?c.sub_accounts.push(b):(b.sub_accounts=[_.omit(b,"sub_accounts")],a.push(b),k(b),j(b)),a},[])}function j(a){a.manuallyAdded&&(a.buttonText="Add Another Account"),(a.failureCount>=w||u(a.errorCode)&&a.failureCount>=x)&&(a.buttonText="Add Account Manually")}function k(a){a.institution_id&&a.remote_id||(a.manuallyAdded=!0)}function l(a){var b=e.DEFAULT.message,c=_.get(a,["response_data","body","rawError","code"]);return{code:c,message:_.get(v,c,b)}}function m(){a.$evalAsync(function(){var d=_.filter(b.data,{connect_status:"active"});a.asyncAccounts=i(d),c.data.forEach(function(b){if(b.connect_status=b.status,"error"===b.connect_status){var c=l(b);b.errorMessage=c.message,b.errorCode=c.code}"mfa_required"===b.connect_status&&(b.buttonText="Answer Challenge Question",b.errorMessage=" ");var d=_.find(a.asyncAccounts,{institution_id:b.institution_id});d?(d.failureCount++,j(d)):(b.failureCount="error"===b.connect_status?1:0,a.asyncAccounts.push(b))})})}function n(a,b){return a.preventDefault(),"mfa_required"===b.connect_status?p(b):!b.manuallyAdded&&b.failureCount<w&&!u(b.errorCode)||!b.manuallyAdded&&b.failureCount<x&&u(b.errorCode)?q(b.institution_id):r(b)}function o(a){return a.manuallyAdded||"error"===a.connect_status||"mfa_required"===a.connect_status}function p(b){g.track("Visited Financial Institution MFA Modal",{"Institution ID":b.institution_id,"Institution Name":b.institution_name}),a.instConn.authModel.getCredentialsForm(b.institution_id).then(function(){a.instConn.alerts&&a.instConn.alerts.items&&a.instConn.alerts.items.length>=0&&(a.instConn.alerts.items=[]),a.instConn.challengeModel.updateModelFromResponse(b.response_data),a.instConn.asyncInstitutionConnectChallengeModal.open({locals:{instConn:a.instConn}}).then(function(){a.instConn.alerts&&a.instConn.alerts.items&&a.instConn.alerts.items.length>=0&&f("#institution-connect-container",10,500)})})}function q(b){return f("#institution-connect-container",10,500),a.instConn.institutionConnectManager.authForInstitution(b)}function r(b){return a.instConn.asyncCreateFinancialAccountModal.open({locals:{isAuthRequired:!0,institutionData:{name:b.institution_name},type:"add_another",onClose:function(a){a&&s(b)}}})}function s(a){c.deleteRequestsForInstitution(a.institution_id)}function t(a){return u(a.errorCode)?(j(a),a.failureCount>=x):a.failureCount>=w}function u(a){return _.includes(y,a)}var v=h(e),w=3,x=2,y=[1205,1206,1211,1219];a.tryAgain=n,a.actionRequired=o,a.isAccountSkippable=t,a.deleteInstitutionConnectRequests=s,d.$on("est-profile-updated",function(){m()}),this.mapErrorCodesToMessages=h,m()}var b=angular.module("clientWww.common.profile.ui-financial.estAsyncLinkedAccounts",["clientWww.common.profile.ui-financial.plaidErrorTypes"]);b.filter("formatAccount",["userModel",function(a){return function(b){var c=a.attributes.data.first_name,d=c+"'s ";switch(b.sub_type){case"checking":case"savings":case"investment":case"cd":return d+_.capitalize(b.sub_type)+" Account";case"home_equity":return d+" Home Equity Account";case"lineofcredit":case"line_of_credit":return d+_.capitalize(b.institution_name)+" Line of Credit";case"creditcard":case"credit_card":return d+_.capitalize(b.institution_name)+" Credit Card";case"mortgage":return d+_.capitalize(b.institution_name)+" Mortgage";case"personal_loan":return d+_.capitalize(b.institution_name)+" Personal Loan";case"student_loan":return d+_.capitalize(b.institution_name)+" Student Loan";default:return"N/A"}}}]),b.directive("estAsyncLinkedAccounts",[function(){return{restrict:"A",templateUrl:"/common/profile/ui-financial/est-async-linked-accounts.html",transclude:!1,replace:!0,controller:"EstAsyncLinkedAccountsController",link:function(a){function b(a){if("error"===a.connect_status||"mfa_required"===a.connect_status)return"icon-accounts-tab-icon-alert";var b={banking:{active:"icon-accounts-tab-icon-checking-green",connecting:"icon-accounts-tab-icon-checking-grey"},creditcard:{active:"icon-accounts-tab-icon-credit-card-green",connecting:"icon-accounts-tab-icon-credit-card-grey"},checking:{active:"icon-accounts-tab-icon-checking-green",connecting:"icon-accounts-tab-icon-checking-grey"},cd:{active:"icon-accounts-tab-icon-savings-green",connecting:"icon-accounts-tab-icon-savings-grey"},savings:{active:"icon-accounts-tab-icon-savings-green",connecting:"icon-accounts-tab-icon-savings-grey"},investment:{active:"icon-accounts-tab-icon-investments",connecting:"icon-accounts-tab-icon-investments"}};return _.get(b,[a.sub_type,a.connect_status])}var c={active:"icon-accounts-tab-icon-check",connecting:"icon-accounts-tab-loader"};a.statusToIconClass=c,a.getIconForStatusAndType=b,a.defaultErrorMessage="There was an error",a.defaultRetryButtonText="Try Again"}}}]),b.controller("EstAsyncLinkedAccountsController",["$scope","financialAccountModel","institutionConnectRequestModel","$rootScope","PLAID_ERROR_TYPES","scrollToElement","analytics",a])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-financial.plaidErrorTypes",[]).constant("PLAID_ERROR_TYPES",{EARNEST_POST_ERROR:{errorCodes:[1e3,1001,1003,1008,1004,1005,1006,1009,1100,1101,1102,1104,1105,1106,1107,1109,1110,1111,1113,1114,1115,1204,1213,1215,1218,1501,1502,1503,1507,1601,1600,1606,1610],message:"We've experienced an issue in attempting to connect with your institution."},ADDITION_LIMIT:{errorCodes:[1112],message:"You have reached the maximum number of additions. Contact us to raise your limit."},USERNAME_OR_PASSWORD:{errorCodes:[1200,1201,1202],message:"The username and/or password provided were incorrect."},MFA:{errorCodes:[1203],message:"The provided multi-factor authentication response was incorrect."},ACCOUNT_LOCKED:{errorCodes:[1205],message:"The account is locked. Log in to your institution's website to unlock and then try again."},NO_ACCOUNTS:{errorCodes:[1212],message:"We were unable to find your accounts at this institution."},ACCOUNT_SETUP_UNFINISHED:{errorCodes:[1206],message:"We're unable to connect. Log in to your institution's website and then try again."},ACCOUNT_UNSUPPORTED:{errorCodes:[1207,1210],message:"This account is currently not supported."},PLAID_NONACTIONIONABLE:{errorCodes:[1208,1300,1301,1303,1307,1702,1800,1700],message:"We've experienced an issue connecting with your institution."},PLAID_RETRY:{errorCodes:[1302,1701],message:"N/A"},PIN:{errorCodes:[1209],message:"The PIN provided was not correct."},BOA_SECURITY:{errorCodes:[1211],message:"The security rules for this account restrict access. Disable 'Extra Security at Sign-In' in your Bank of America settings."},WF_SECURITY:{errorCodes:[1219],message:"The security rules for this account restrict access. Disable 'Enhanced Sign On' in your Wells Fargo settings."},DEFAULT:{message:"We've experienced an issue in attempting to connect with your institution."}})}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){var y=this,z=i.VISA_TYPES;this.scope=c,this.userData=i.attributes.data,this.isCosignerApplication="cosigner.profile.personal"===b.current.name,this.cosignerEligible=k.cosignerEligible(),this.showCondensedUploader=o.isMobileBrowser,this.idUploader=new f({category:g.CATEGORIES.ID,validationRequiredMessage:n.personal_profile.identification_id,isCondensedUploader:this.showCondensedUploader}),this.documentUploader=new f({category:g.CATEGORIES.OTHER,autoUpload:!1}),this.passportUploader=new f({category:g.CATEGORIES.PASSPORT,validationRequiredMessage:n.personal_profile.identification_id,isCondensedUploader:this.showCondensedUploader}),this.greenCardAppUploader=new f({category:g.CATEGORIES.GREEN_CARD_APPLICATION,validationRequiredMessage:n.personal_profile.identification_id,isCondensedUploader:this.showCondensedUploader}),this.CITIZENSHIP_STATUSES=i.CITIZENSHIP_STATUSES,this.others=i.attributes.data.misc.others,this.contactPrefs=h,this.userModel=i.attributes.data,this.originalUserModel=_.clone(i.attributes.data),this.isLoanEditable="apply"===k.attributes.data.status,this.errorMessages=m.personal,this.idFiles=g.idFiles,this.passportFiles=g.passportFiles,this.greenCardAppFiles=g.greenCardAppFiles,this.otherFiles=g.otherFiles,this.fileCollection=g,this.showUploader="profile.personal"===b.current.name||"cosigner.profile.personal"===b.current.name||"student.profile.personal"===b.current.name&&k.isStudentLoanOrigination()||!a.featureFlags.hideIDUploadEnabled&&k.isStudentLoanRefinance()&&"student.profile.personal"===b.current.name,this.citizenshipStatusOptions=_(this.CITIZENSHIP_STATUSES).map(function(a){return(!k.isStudentLoan()||a!==y.CITIZENSHIP_STATUSES.VISA_HOLDER)&&{value:a,text:a}}).compact().value(),this.visaTypeOptions=_.map(z,function(a){return{value:a,text:a}}),this.violatesVisaCondition=!1,this.eligibleForVisaConditionCheck=function(){return!!k.isPersonalLoan()&&(y.clientHasGreenCardVisaType()&&!_.isUndefined(y.others.citizenship_has_applied)&&!y.others.citizenship_has_applied||!y.clientHasGreenCardVisaType())},this.cannotExtendVisa=function(){return y.visaExpiringWithinOneYear()&&!y.visaExpiringWithinSixMonths()},this.shouldEditLoanTerm=function(){return y.visaExpiringBeforeLoanTerm()&&!y.visaExpiringWithinOneYear()},this.cannotApplyWithVisaDetails=function(){return!_.isUndefined(y.others.has_extended_visa)&&y.visaExpiringWithinSixMonths()&&!y.others.has_extended_visa},this.visaExpiringBeforeLoanTerm=function(){var a=moment().add(k.attributes.data.term,"days").add(3,"months").add(7,"days");return this.visaExpiringBefore(a)},this.visaExpiringWithinSixMonths=function(){var a=moment().add(6,"months");return this.visaExpiringBefore(a)},this.visaExpiringWithinOneYear=function(){var a=moment().add(1,"year");return this.visaExpiringBefore(a)},this.visaExpiringBefore=function(a){var b=y.others.citizenship_expiration_date;if(b&&moment(b).isValid()){return moment(b).isBefore(a)}return!1},this.checkVisaConditions=function(){y.eligibleForVisaConditionCheck()&&(y.cannotExtendVisa()?(y.violatesVisaCondition=!0,r.open()):y.shouldEditLoanTerm()?(y.violatesVisaCondition=!0,s.open()):y.cannotApplyWithVisaDetails()?(y.violatesVisaCondition=!0,p.addAlert("warning","Sorry! We are not able to lend to clients with a visa expiring before the end of the loan term.")):y.violatesVisaCondition=!1)},this.clientIsUSCitizen=function(){return this.others.citizenship_status===this.CITIZENSHIP_STATUSES.US_CITIZEN},this.clientIsResidentAlien=function(){return this.others.citizenship_status===this.CITIZENSHIP_STATUSES.RESIDENT_ALIEN},this.clientIsVisaHolder=function(){return this.others.citizenship_status===this.CITIZENSHIP_STATUSES.VISA_HOLDER},this.clientIsValidVisaHolder=function(){return this.clientIsVisaHolder()&&this.others.citizenship_visa_type&&this.others.citizenship_visa_type!==z.NONE},this.clientIdCanExpire=function(){return this.clientIsResidentAlien()||this.clientIsValidVisaHolder()},this.clientHasAppliedForCitizenship=function(){return this.others.citizenship_has_applied},this.clientHasGreenCardVisaType=function(){return[z.H1B,z.F1OPT].indexOf(this.others.citizenship_visa_type)>-1},this.requiresIdUpload=function(){return this.clientIsUSCitizen()||this.clientIsResidentAlien()||this.clientIsValidVisaHolder()},this.getIdUploadContainerSizeClass=function(){return this.others.citizenship_status===this.CITIZENSHIP_STATUSES.VISA_HOLDER?"multiple":this.getShowFileDetailBoolean(this.idFiles[0],this.idUploader)?"small":""},this.getDocumentUploadSizeClass=function(){return this.otherFiles.length&&this.documentUploader.isStarting()?"small-file-uploader":""},this.getShowFileDetailBoolean=function(a,b){return a&&b.isStarting()},this.setUploaderErrorMessage=function(a){y.uploaderErrorMessage=a},this.checkLoanMinimums=function(){var a=k.isStudentLoan()?i.hasStudentLoanRefiMinimum():i.hasPersonalLoanMinimum();return!1!==a&&k.attributes.data.amount_requested<a.minimumLoan?(v.limits=a,k.attributes.data.amount_requested=a.minimumLoan,k.put(),v.open(a)):q.when(!1)};var A=!0;this.livingSituationChange=function(){if(A){var a=j.attributes.housing_payment;"I rent"===this.others.living_situation&&(this.others.monthly_rent=a),"I own"===this.others.living_situation&&(this.others.monthly_mortgage_payment=a),A=!1}else this.others.monthly_rent="",this.others.monthly_mortgage_payment=""};var B=moment(a.slrConversionDates.demographicDataRestrictionStartDate).startOf("day").toDate(),C=moment(a.slrConversionDates.demographicDataRestrictionEndDate).endOf("day").toDate();c.isSLO=function(){return k.isStudentLoanOrigination()},c.checkForPOBox=function(){var a=/^(?:Post(?:al)? (?:Office)? |P[.\ ]?O\.?)? ?Box\b/gi;c.addressIsPOBox=a.test(y.userModel.street_1)},c.additionalSLOCopy=c.isSLO?" - such as any extenuating circumstances.":".",c.citizenshipStatusMessage="U.S citizens, permanent residents and other U.S. residents with valid visas are eligible for Earnest loans. Proof of status is required.",this.RELATIONSHIP_TO_STUDENT=i.RELATIONSHIP_TO_STUDENT,this.relationshipToStudentOptions=_(this.RELATIONSHIP_TO_STUDENT).map(function(a){return{value:a,text:_.capitalize(a)}}).compact().value(),c.showMobileDisclosure=!1,c.toggleMobileDisclosue=function(){c.showMobileDisclosure=!c.showMobileDisclosure},c.others=i.attributes.data.misc.others,c.contactPrefs=h,c.userModel=i.attributes.data,c.Loan=k,c.LoanList=l,c.isLoanEditable="apply"===k.attributes.data.status,g.init().then(function(){y.otherFiles.length&&(y.hasOtherDocuments=!0)}),c.saveAndGoNavientCheck=function(a,b){var d=["mobile_phone","street_1","street_2","city","state","zip"],e=_.pick(y.originalUserModel,d),f=_.pick(y.userModel,d)
;c.saveAndGo(a,b).then(function(a){!_.isEqual(e,f)&&c.loanServicedByNavient&&c.loanServicedByNavient.id&&w.open({locals:{loanId:c.loanServicedByNavient.id}})})},c.personalSaveAndGo=function(){return"student_loan_refinance"===k.attributes.data.type&&u.trackEvent("SLRPersonalClickedCTA"),y.checkLoanMinimums().then(function(){return t(c)})},c.showPreviousAddress=c.LoanList.data.length<2&&("profile.personal"===b.current.name||"student.profile.personal"===b.current.name||"cosigner.profile.personal"===b.current.name),c.cannotEditAddress=i.attributes.data.is_immutable&&!_.all(c.LoanList.data,function(a){return _.contains(["apply","active","agreed","repaid","approval_expired","time_out","void","decline"],a.status)}),c.loanServicedByNavient=_.find(c.LoanList.data,function(a){return"navient"===a.loan_servicer&&a.is_boarded&&a.is_serviced}),c.isDemographicDataDisabled=_.find(c.LoanList.data,function(a){return k.isDemographicDataDisabled(B,C,a)}),e(function(){x.then(function(a){var b=document.getElementById("street_1");y.autocomplete=new a.places.Autocomplete(b,{types:["address"]}),a.event.addListener(y.autocomplete,"place_changed",y.setAutocompleteAddress)})},0),this.autocompleteKeydown=function(a){13===a.keyCode&&$(".pac-container:visible").length&&a.preventDefault()},this.setAutocompleteAddress=function(){var a,b,d,f="",g="",h=y.autocomplete.getPlace(),i=h.address_components;_.each(i,function(c){switch(c.types[0]){case"locality":a=c.long_name;break;case"administrative_area_level_1":b=c.short_name;break;case"street_number":f=c.long_name;break;case"route":case"street_name":g=c.long_name;break;case"postal_code":d=c.long_name}}),c.$apply(function(){y.userData.street_1=f+" "+g,y.userData.city=a,y.userData.state=b,y.userData.zip=d,y.expandAddress=!0,y.checkStateAvailability()}),c.$watch("self.userData.street_1",function(){e(function(){$("#street_1").val(y.userData.street_1)},1)})},this.checkStateAvailability=function(){y.userData.state&&!i.isStateOk(k.attributes.data.type)?(y.invalidState=!0,p.addAlert("error","Earnest is not available to lend in your state yet.",null,null,null)):i.isStateOk(k.attributes.data.type)&&(y.invalidState=!1,p.clearAll())}}var b=angular.module("clientWww.common.profile.ui-personal.personal",["clientWww.common.modals.navientSync","clientWww.common.profile.ui-personal.VisaEditLoanTermModal","clientWww.common.profile.ui-personal.VisaExtensionModal","clientWww.profile.profileConstants","clientWww.common.pageAlerts","clientWww.loans.loansModel","clientWww.common.getDevice","clientWww.common.filters","clientWww.common.directives","clientWww.common.upload","clientWww.user","calculators","ui.router","uiGmapgoogle-maps"]);b.config(["CONFIG","uiGmapGoogleMapApiProvider",function(a,b){b.configure({key:a.googleMaps.apiKey,v:"3.25",libraries:"places"})}]),b.controller("ProfileOthersController",["CONFIG","$state","$scope","$window","$timeout","Uploader","fileCollection","contactPrefs","userModel","QuickRateScoreModel","Loan","LoanList","ProfileErrorMessages","UPLOADER_ERROR_MESSAGES","getDevice","pageAlerts","$q","VisaExtensionModal","VisaEditLoanTermModal","saveProfileAndGo","optimizelyService","LoanAmountMinimumModal","NavientSyncModal","uiGmapGoogleMapApi",a])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.ui-personal.VisaEditLoanTermModal",["common.ui.modal"]);a.factory("VisaEditLoanTermModal",["EstModalFactory",function(a){return new a({name:"VisaEditLoanTermModal",templateUrl:"/common/profile/ui-personal/visa-edit-loan-term-modal.html",controller:"VisaEditLoanTermModalController"})}]),a.controller("VisaEditLoanTermModalController",["$scope","$state",function(a,b){a.editLoanTerm=function(){a.close(),b.go("profile.start")}}])}(),function(){"use strict";var a=angular.module("clientWww.common.profile.ui-personal.VisaExtensionModal",["common.ui.modal"]);a.factory("VisaExtensionModal",["EstModalFactory",function(a){return new a({name:"VisaExtensionModal",templateUrl:"/common/profile/ui-personal/visa-extension-required-modal.html",controller:"VisaExtensionModalController"})}]),a.controller("VisaExtensionModalController",["$scope","userModel","redirect","SSO",function(a,b,c,d){a.signOut=function(){return b.logout().then(function(){d.ssoRedirectLogout("/")})}}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-add-cosigner.add-cosigner",["clientWww.common.profile.ui-add-cosigner.encourageCosignerModal","ui.router"]).controller("ProfileAddCosignerController",["$scope","Loan","ApplicantInvitation","sharingPolicyModal","saveProfileAndGo","loadPromise","$q","pageAlerts","productAvailability","encourageCosignerModal","QuickRateScoreModel","employmentModel",function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){var a=!k.isScored()&&!o||!l.hasTwoPlusYearsWorkExperience();return o=!0,a}var n=this;n.invitation=c.data,n.Loan=b,n.add_cosigner=!0,n.addCosigner=function(){var i;if(n.add_cosigner)i=d.open().then(function(d){return"agreed-to-sharing-policy"===d?c.addCosigner(b.attributes.data.id,{first_name:n.invitation.first_name,last_name:n.invitation.last_name,email:n.invitation.email}).then(function(){return e(a)}):g.when()});else if(!n.add_cosigner){if(m())return q();i=c.removeCosigners({loan_id:b.attributes.data.id}).then(function(){return e(a)})}return f(a,i,h)},n.checkStateAvailability=function(a){a&&!i.isStateOk(a,b.attributes.data.type)?(n.isStateOk=!1,n.add_cosigner_form.state.$setValidity("state",!1)):(a&&i.isVariableRateOk(a),n.isStateOk=!0,n.add_cosigner_form.state.$setValidity("state",!0))};var o=!1,p=function(){return{locals:{onContinuePromiseGetter:function(){return c.removeCosigners({loan_id:b.attributes.data.id}).then(function(){return e(a)})}}}},q=function(){return j.open(p())};a.isSLO=function(){return b.isStudentLoanOrigination()}}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-add-cosigner.encourageCosignerModal",["common.ui.modal"]).factory("encourageCosignerModal",["EstModalFactory",function(a){return new a({name:"encourage-cosigner-modal",templateUrl:"/common/profile/ui-add-cosigner/encourage-cosigner-modal.html",controller:"EncourageCosignerModalController as ctrl"})}]).controller("EncourageCosignerModalController",["$scope","$q",function(a,b){a.closeAndContinue=function(){return b.all([a.close(),a.onContinuePromiseGetter()])},a.closeAndStay=function(){return b.all([a.close(),a.newFutureEmployment()])}}])}(),function(){"use strict";angular.module("clientWww.common.profile.ui-complete.complete",[]).controller("ProfileCompleteController",["$scope","$q","userModel","LOAN_CONSTANTS","NewLoanCalc","RevenueCalculator","Loan","TaxCalculator","sourceModel","ElectronicAgreementModal","TermsOfServiceModal","PrivacyPolicyModal","Alerts","analytics","navigationModel","$exceptionHandler","redirect","APP_URLS","loadPromise","clientHappinessModal","CONFIG","ProcessingDelayModal","flagger","FLAG_NAMES",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x){a.alerts=new m("Ssn"),a.User=c,a.isStateOk=c.isStateOk(g.attributes.data.type),g.attributes.data.funds_transfer_initiated=g.attributes.data.funds_transfer_initiated||new Date;var y=_.clone(g.attributes.data),z=_.clone(g.attributes.data),A=new h,B=d.ratesForPersonalLoanTerm(g.attributes.data.term);y.interest_rate=B.min,z.interest_rate=B.max;var C=new e(y),D=new e(z);if(a.rate=g.attributes.data.interest_rate||B,a.loanData=g.attributes.data,a.monthlyPayment=g.attributes.data.equal_payment_amount,a.monthlyPaymentMin=C.getPaymentAmounts()[0],a.monthlyPaymentMax=D.getPaymentAmounts()[0],a.interestRemaining=g.attributes.data.interest_remaining,a.totalCost=g.attributes.data.total_cost,a.amountRequested=g.attributes.data.amount_requested,a.term=g.attributes.data.term,a.completed=!0,i.isGraduatedRepayment()){var E=g.attributes.data.summary_payment_schedule;a.minimumPayment={amount:E[0].amount,startDate:E[0].startDate,endDate:E[1].startDate},a.monthlyPayment=E[1].amount}"FL"===c.attributes.data.state&&(a.taxAmount=A.taxAmount(g.attributes.data.amount_requested,c.attributes.data.state)),a.submit=function(){function d(){return h?(e.track(),v.open({locals:{SUBMIT_LATER:i,CONTINUE_ANYWAY:j,close:function(a){v.close(a||i)}}}).then(function(a){return a===i?b.reject(i):(e.trackConversionEvent("View Processing Delay Modal",{"Option Selected":j}),c.save())})):c.save()}var e=w.getTest(x.processing_delay_modal),h=e.hasVariation("Modal Displayed"),i="Submit Later",j="Continue Anyway",k=d().then(function(){return g.apply()}).then(function(){var a=.0826,b=30,c=(new f).estimateLoanNPV(g.attributes.data.amount_requested/100,a,b);return n.track("apply for loan",{"Estimated Revenue":c}),g.associateWithReferrer().catch(function(a){p(a)})}).then(function(){return o.getIndex()}).then(function(){return u.featureFlags.synchronousAI&&g.attributes.data.show_sync_ai?q.hrefUrl("/dashboard/#/loan/"+g.id+"/analyze"):q.hrefUrl("/dashboard/#/overview")}).catch(function(a){a===i&&e.trackConversionEvent("Viewed Processing Delay Modal",{"Option Selected":i})});return s(a,k,a.alerts)},a.openClientHappinessModal=function(){t.open()},a.openElectronicAgreement=function(){j.open()},a.openTermsOfService=function(){k.open()},a.openPrivacyPolicy=function(){l.open()}}])}(),function(){"use strict";angular.module("clientWww.profile.uiComplete.electronicAgreement",[]).controller("ElectronicAgreementModalController",["$scope",function(a){a.canClose=!1,a.closeAgreement=function(){return a.canClose=!0,a.close()}}]).factory("ElectronicAgreementModal",["EstModalFactory",function(a){return new a({name:"electronic-agreement",templateUrl:"/common/profile/ui-complete/electronic-agreement-modal.html",controller:"ElectronicAgreementModalController"})}])}(),function(){"use strict";angular.module("clientWww.profile.uiComplete.termsOfService",[]).controller("TermsOfServiceModalController",["$scope",function(a){a.canClose=!1,a.closeAgreement=function(){return a.canClose=!0,a.close()}}]).factory("TermsOfServiceModal",["EstModalFactory",function(a){return new a({name:"terms-of-service",templateUrl:"/common/profile/ui-complete/terms-of-service-modal.html",controller:"TermsOfServiceModalController"})}])}(),function(){"use strict";angular.module("clientWww.profile.uiComplete.privacyPolicy",[]).controller("PrivacyPolicyModalController",["$scope",function(a){a.canClose=!1,a.closeAgreement=function(){return a.canClose=!0,a.close()}}]).factory("PrivacyPolicyModal",["EstModalFactory",function(a){return new a({name:"privacy-policy",templateUrl:"/common/profile/ui-complete/privacy-policy-modal.html",controller:"PrivacyPolicyModalController"})}])}(),function(){"use strict";var a=angular.module("clientWww.profile.uiComplete.applicationSolicitationDisclosure",[]);a.controller("AppSolicitationModalController",["$scope","userModel","constants","Loan","liborModel","RateRanges","RateCalculatorWrapper",function(a,b,c,d,e,f,g){var h=d.attributes.data;a.Loan=d,a.canClose=!1,a.filePath="variable",a.closeDisclosure=function(){return a.canClose=!0,a.close()},a.toggleType=function(b){a.filePath="fixed"===b?"fixed":"variable"},a.constants=c,a.userModel=b,a.todaysDate=new Date,a.liborValue=e.value;var i=f.determineRateMaps(h),j=f.findRateRanges(i);a.minFixedRate=j.fixed.min,a.maxFixedRate=j.fixed.max,a.minVariableRate=j.variable.min,a.maxVariableRate=j.variable.max}]),a.factory("ApplicationSolicitationDisclosureModal",["EstModalFactory",function(a){return new a({name:"application-solicitation-disclosure",templateUrl:"/common/profile/ui-complete/application-solicitation-disclosure-modal.html",controller:"AppSolicitationModalController"})}])}(),function(){"use strict";angular.module("clientWww.loanAgreement",["clientWww.loanAgreement.loanAgreementApi","clientWww.loanAgreement.loanAgreementModel","clientWww.loanAgreement.attributes","clientWww.loanAgreement.loanAgreementSnapshotApi","clientWww.loanAgreement.loanAgreementSnapshotModel","clientWww.loanAgreement.loanAgreementSnapshotAttributes"])}(),function(){"use strict";angular.module("clientWww.loanAgreement.loanAgreementModel",[]).factory("LoanAgreement",["LoanAgreementApi","$q","LoanAgreementAttributes","Loan",function(a,b,c,d){var e=function(){this.attributes=new c,this.flagUpdate=!1,this.consentToEsign=!1,this.Loan=d,this.isCosigner="cosigner"===d.attributes.data.application.applicant_role};return e.prototype.getAgreement=function(b){var c=this;return a.getAgreement(b).then(function(a){return a.data.signature=null,a.data.last_four_ssn=null,c.attributes.update(a)})},e.prototype.agreeToLoan=function(c){var d=this;if(d.attributes.data.last_four_ssn||d.attributes.data.opt_out_ach||d.isCosigner){return d.flagUpdate?a.updateAgreement(c,d.attributes.data):a.createAgreement(c,d.attributes.data)}return b.reject(Error("Please either opt in to ACH or opt out by checking the box."))},new e}])}(),function(){"use strict";angular.module("clientWww.loanAgreement.loanAgreementApi",["common.api","clientWww.common.baseApi"]).factory("LoanAgreementApi",["baseApi",function(a){var b=function(){};return b.prototype.createAgreement=function(b,c){return a.request("POST","loans/"+b+"/agreement",c,{withCredentials:!0})},b.prototype.updateAgreement=function(b,c){return a.request("PUT","loans/"+b+"/agreement",c)},b.prototype.getAgreement=function(b){return a.request("GET","loans/"+b+"/agreement")},b.prototype.getPrimaryAgreement=function(b){return a.request("GET","loans/"+b+"/primary-agreement")},new b}])}(),function(){"use strict";angular.module("clientWww.loanAgreement.attributes",["common.model"]).factory("LoanAgreementAttributes",["CommonModelDocument",function(a){var b={id:null,loan_id:null,last_four_ssn:null,opt_out_ach:!1,signature:null,date_signed:new Date,right_to_cancel_end_date:null},c="loanAgreementAttributes",d=a.createSubclass(c,b);return d.emptyData=b,d}])}(),function(){"use strict";angular.module("clientWww.loanAgreement.loanAgreementSnapshotModel",[]).factory("LoanAgreementSnapshot",["LoanAgreementSnapshotApi","LoanAgreementSnapshotAttributes","Loan",function(a,b,c){var d=function(){this.attributes=new b};return d.prototype.post=function(b){return a.post(b,this.attributes.data)},d.prototype.get=function(b,c){var d=this;return a.get(b,c).then(function(a){return d.attributes.update(a),d.attributes.data})},new d}])}(),function(){"use strict";angular.module("clientWww.loanAgreement.loanAgreementSnapshotApi",["common.api","clientWww.common.baseApi"]).factory("LoanAgreementSnapshotApi",["baseApi",function(a){var b=function(){};return b.prototype.post=function(b,c){return a.request("POST","loans/"+b+"/snapshot",c,{withCredentials:!0})},b.prototype.get=function(b,c){return a.request("GET","loans/"+b+"/snapshot/"+(c||""))},new b}])}(),function(){"use strict";angular.module("clientWww.loanAgreement.loanAgreementSnapshotAttributes",["common.model"]).factory("LoanAgreementSnapshotAttributes",["CommonModelDocument",function(a){var b={autopay_discount_amount:null,payment_amount_requested:null,term:null,interest_rate:null,rate_type:null,offer_id:null,application_id:null},c="loanAgreementSnapshotAttributes",d=a.createSubclass(c,b);return d.emptyData=b,d}])}(),function(){"use strict";angular.module("clientWww.loanPriceOffer",["clientWww.loanPriceOffer.loanPriceOfferModel","clientWww.loanPriceOffer.loanPriceOfferApi"])}(),function(){"use strict";angular.module("clientWww.loanPriceOffer.loanPriceOfferModel",[]).factory("LoanPriceOffer",["LoanPriceOfferApi","Loan",function(a,b){var c=function(){};return c.prototype.getSummaryOffer=function(b){return a.getSummaryOffer(b).then(function(a){return self.summaryOffer=a.data,self.summaryOffer})},c.prototype.getDashboardOffer=function(b){var c=this;return a.getDashboardOffer(b).then(function(a){return c.dashboardOffer=a.data,c.dashboardOffer})},c.prototype.getLoanPriceOfferSliderPrices=function(b){var c=this;return a.getLoanSliderPrices(b).then(function(c){return c.data&&c.data.rates&&Object.keys(c.data.rates).length<=0?a.getLoanSliderPrices(b,100):c}).then(function(c){return c.data&&c.data.rates&&Object.keys(c.data.rates).length<10?a.getLoanSliderPrices(b,10):c}).then(function(a){return c.sliderPrices=a.data,c.sliderPrices})},new c}])}(),function(){"use strict";angular.module("clientWww.loanPriceOffer.loanPriceOfferApi",["clientWww.common.baseApi"]).factory("LoanPriceOfferApi",["baseApi",function(a){var b=function(){};return b.prototype.getSummaryOffer=function(b){return a.request("GET","loans/"+b+"/offers/summary")},b.prototype.getDashboardOffer=function(b){return a.request("GET","loans/"+b+"/offers/dashboard")},b.prototype.getLoanSliderPrices=function(b,c){return a.request("GET","loans/"+b+"/offers",{primary_pivot:"regular_payment_amount",secondary_pivot:"type",filter:"slider_gaps",notch_difference:c})},new b}])}(),function(){"use strict";angular.module("clientWww.selfCertification",["clientWww.selfCertification.selfCertificationApi","clientWww.selfCertification.selfCertificationModel","clientWww.selfCertification.attributes"])}(),function(){"use strict";angular.module("clientWww.selfCertification.selfCertificationModel",[]).factory("SelfCertification",["SelfCertificationApi","SelfCertificationAttributes","$q",function(a,b,c){var d=function(){this.attributes=new b};return d.prototype.submit=function(b,c){var d=this;return a.createSelfCertification(b,c).then(function(a){return d.attributes.update(a)})},d.prototype.getSelfCertification=function(b){var c=this;return a.getSelfCertification(b).then(function(a){return c.attributes.update(a)})},d.prototype.signSelfCertification=function(){var b=this,c=this.attributes.data;return a.signSelfCertification(c.application_id,c.id,c).then(function(a){return b.attributes.update(a)})},new d}])}(),function(){"use strict";angular.module("clientWww.selfCertification.selfCertificationApi",["common.api","clientWww.common.baseApi"]).factory("SelfCertificationApi",["baseApi",function(a){var b=function(){};return b.prototype.createSelfCertification=function(b,c){return a.request("POST","application/"+b+"/self-certification",c)},b.prototype.getSelfCertification=function(b){return a.request("GET","application/"+b+"/self-certification")},b.prototype.signSelfCertification=function(b,c,d){return a.request("POST","application/"+b+"/self-certification/"+c+"/sign",d)},new b}])}(),function(){"use strict";angular.module("clientWww.selfCertification.attributes",["common.model"]).factory("SelfCertificationAttributes",["CommonModelDocument",function(a){var b={id:null,application_id:null,first_name:null,last_name:null,date_of_birth:null,students_first_name:null,students_last_name:null,students_date_of_birth:null,students_ssn:null,school_name:null,school_address:null,street_1:null,street_2:null,city:null,state:null,zip:null,mobile_phone:null,email:null,academic_term_end_date:null,academic_term_start_date:null,estimated_attendance_cost:null,financial_assistance:null,signature:null,date_signed:new Date},c="SelfCertificationAttributes",d=a.createSubclass(c,b);return d.emptyData=b,d}])}(),function(){"use strict";angular.module("clientWww.quickRateScore",["clientWww.quickRateScore.model"])}(),function(){"use strict";angular.module("clientWww.quickRateScore.model",["clientWww.common.baseApi"]).factory("QuickRateScoreModel",["baseApi","$timeout","$q","CONFIG",function(a,b,c,d){var e=function(){this.TIMEOUT_INTERVAL=5e3,this.debugFicoScore=void 0,this.debugQuickScore=void 0,this.attributes={id:void 0,score:void 0,stated_income:void 0,future_income:void 0,stated_savings:void 0,school_name:void 0,school_id:void 0,degree_type:void 0,job_title:void 0,amount_requested:void 0,affordability_cap:void 0,employer:void 0,decision_reason_text:void 0,referrer:void 0,quoted_rate_map:void 0,type:void 0,is_expired:void 0,residency_end_date:void 0,use_dynamic_score:void 0,misc:{}}},f=function(){var a={fico_score:this.debugFicoScore};if(!this.debugQuickScore)return a;var b={unable:null,scored:6,decline:2};return _.assign(a,{score:b[this.debugQuickScore],decision:this.debugQuickScore})};return e.prototype.createScore=function(b,c){return this.attributes.amount_requested=b,this.attributes.type=c,d.switches.debug&&(this.attributes.overrides=_.bind(f,this)()),a.request("POST","quick-scores",this.attributes)},e.prototype.createEligibilityScore=function(b,c,e){return this.attributes.amount_requested=b,this.attributes.invitation_token=c,this.attributes.relationship_to_primary=e.title,this.attributes.relationship_explanation=e.explanation,d.switches.debug&&(this.attributes.overrides=_.bind(f,this)()),a.request("POST","eligibility-scores",this.attributes)},e.prototype.getScore=function(c){var d=this,e=c||d.attributes.id;return a.request("GET","quick-scores/"+e).then(function(a){return a&&a.data&&200===a.status?(d.attributes.id=a.data.id,d.attributes.score=a.data.score,d.attributes.affordability_cap=a.data.affordability_cap,d.attributes.decision=a.data.decision,d.attributes.degree_type=a.data.degree_type,d.attributes.school_id=a.data.school_id,d.attributes.grad_month=a.data.grad_month,d.attributes.grad_year=a.data.grad_year,d.attributes.employer=a.data.employer,d.attributes.job_title=a.data.job_title,d.attributes.stated_income=a.data.stated_income,d.attributes.future_income=a.data.future_income,d.attributes.stated_savings=a.data.stated_savings,d.attributes.housing_payment=a.data.housing_payment,d.attributes.referrer=a.data.referrer,d.attributes.decision_reason_text=a.data.decision_reason_text||"Out of respect for your time we wanted to let you know that it seems unlikely we will have a competitive interest rate for you. Earnest evaluates each applicant's entire financial profile, and the initial analysis of your information has indicated that Earnest is not the right fit for you.",d.attributes.quoted_rate_map=a.data.quoted_rate_map,d.attributes.is_expired=a.data.is_expired,d.attributes.type=a.data.type,d.attributes.residency_end_date=a.data.residency_end_date,d.attributes.use_dynamic_score=a.data.use_dynamic_score||!1,d.attributes):a&&202===a.status?b(function(){return d.getScore(c)},d.TIMEOUT_INTERVAL):void 0})},e.prototype.getEligibilityScore=function(){var c=this;return a.request("GET","/eligibility-scores/me").then(function(a){return a&&a.data&&200===a.status?(c.attributes.score=a.data.score,c.attributes.affordability_cap=a.data.affordability_cap,c.attributes.decision=a.data.decision,c.attributes.stated_savings=a.data.stated_savings,c.attributes.decision_reason_text=a.data.decision_reason_text||"Out of respect for your time we wanted to let you know that it seems unlikely we will have a competitive interest rate for you. Earnest evaluates each applicant's entire financial profile, and the initial analysis of your information has indicated that Earnest is not the right fit for you.",c.attributes.quoted_rate_map=a.data.quoted_rate_map,c.attributes):a&&202===a.status?b(function(){return c.getEligibilityScore()},c.TIMEOUT_INTERVAL):void 0})},e.prototype.getQuickScoreDashboardOffer=function(b){var c=this,d=b||c.attributes.id;return a.request("GET","quick-scores/"+d+"/offers/dashboard").then(function(a){return c.quickScoreDashboardOffer=a.data,c.quickScoreDashboardOffer})},e.prototype.getRateMap=function(){return this.attributes.quoted_rate_map?this.attributes.quoted_rate_map.maps:null},e.prototype.getSchools=function(b){return a.request("GET","schools",b)},e.prototype.getSchoolPrograms=function(b){return a.request("GET","schools/"+b.id+"/programs",_.omit(b,["id"]))},e.prototype.getProgram=function(b){return a.request("GET","schools/programs/"+b.id)},e.prototype.hasFutureIncome=function(){return Boolean(this.attributes.future_income)},e.prototype.hasStatedIncome=function(){return Boolean(this.attributes.stated_income)},e.prototype.isScored=function(){return"scored"===this.attributes.decision},e.prototype.isDiscouraged=function(){return"decline"===this.attributes.decision},e.prototype.isUnable=function(){return"unable"===this.attributes.decision},new e}])}(),function(){"use strict";angular.module("clientWww.packetScore.packetScoreModel",["clientWww.common.baseApi"]).factory("PacketScore",["baseApi",function(a){var b=function(){this.attributes={loan_id:void 0,applicant_invitation_token:void 0}};return b.prototype.createScore=function(b,c){return this.attributes.loan_id=b,this.attributes.applicant_invitation_token=c,a.request("POST","packet-scores",this.attributes)},new b}])}(),function(){"use strict";angular.module("clientWww.canonicalLoanServicer",["clientWww.canonicalLoanServicer.canonicalLoanServicerApi","clientWww.canonicalLoanServicer.canonicalLoanServicerModel"])}(),function(){"use strict";angular.module("clientWww.canonicalLoanServicer.canonicalLoanServicerModel",[]).factory("CanonicalLoanServicerModel",["CanonicalLoanServicerApi",function(a){var b=function(){this.data=[]};return b.prototype.getAll=function(){var b=this;return a.get().then(function(a){b.data=a.data})},b.prototype.findById=function(a){return _.find(this.data,{id:a})},b.prototype.findUniqueServicers=function(){return _.unique(this.data,"name")},b.prototype.findAddressesForServicer=function(a){return _(this.data).map(function(b){if(String(b.name).trim().toLowerCase().replace(/ /g,"_")===a)return b}).compact().value()},new b}])}(),function(){"use strict";angular.module("clientWww.canonicalLoanServicer.canonicalLoanServicerApi",["common.api","clientWww.common.baseApi"]).factory("CanonicalLoanServicerApi",["baseApi",function(a){var b=function(){};return b.prototype.get=function(){return a.request("GET","canonical_loan_servicers")},new b}])}(),function(){"use strict";angular.module("clientWww.common.directives.estAccordion",[]).directive("estAccordion",[function(){return{restrict:"A",link:function(a,b,c){var d=0,e=a.$watch(function(){d=0===d?b[0].offsetHeight:d,e()});a.$watch(c.estAccordion,function(a){a?b.animate({height:d+"px"},500,"swing",function(){b.css("height","auto")}):(d=b[0].offsetHeight>0?b[0].offsetHeight:d,b.animate({height:0},500,"swing"))})}}}])}();